

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Figure 7: Myelin-Dependent Motor Recovery &#8212; VNS Myelin Manuscript Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=bd9e20870c6007c4c509" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=bd9e20870c6007c4c509"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'figure7_longtermMyelin';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Figure 6 Neuropixels" href="figure6_Neuropixels.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <header>
  
    <div class="bd-header navbar navbar-expand-lg bd-navbar">
    </div>
  
  </header>

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">VNS Myelin Manuscript Book</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Paired Vagus Nerve Stimulation Drives Precise Remyelination and Motor Recovery After Myelin Loss
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Figures</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="figure6_Neuropixels.html">Figure 6: Neuropixels</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Figure 7: Myelin-Dependent Long-Term Recovery</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/figure7_longtermMyelin.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Figure 7: Myelin-Dependent Motor Recovery</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-a-experimental-timeline">Panel a (Experimental Timeline)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-b-long-term-functional-recovery">Panel b: (Long-Term Functional Recovery)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-c-oligodendrocyte-quantity-vs-recovery">Panel c (Oligodendrocyte Quantity vs. Recovery)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-d-sheath-quantity-vs-recovery">Panel d (Sheath Quantity vs. Recovery)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-e-pattern-fidelity-drives-recovery">Panel e (Pattern Fidelity Drives Recovery)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-f-myrf-experimental-timeline">Panel f (Myrf Experimental Timeline)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-g-oligodendrogenesis-is-required-for-paired-vns-efficacy">Panel g: Oligodendrogenesis is Required for Paired-VNS Efficacy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extended-data-figures">Extended Data Figures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extended-data-figure-7">Extended Data Figure 7</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-f">a —- f</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#g">g</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extended-data-figure-8">Extended Data Figure 8</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-c">a — c</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#d-f">d — f</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="figure-7-myelin-dependent-motor-recovery">
<h1>Figure 7: Myelin-Dependent Motor Recovery<a class="headerlink" href="#figure-7-myelin-dependent-motor-recovery" title="Permalink to this heading">#</a></h1>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>

<span class="kn">from</span> <span class="nn">tqdm</span> <span class="kn">import</span> <span class="n">tqdm_notebook</span> <span class="k">as</span> <span class="n">tqdm</span>

<span class="kn">import</span> <span class="nn">nelpy</span> <span class="k">as</span> <span class="nn">nel</span>
<span class="kn">import</span> <span class="nn">nelpy.plotting</span> <span class="k">as</span> <span class="nn">npl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1.inset_locator</span> <span class="kn">import</span> <span class="n">inset_axes</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Patch</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1"># Manuscript Mode Setup (White Background / Black Text)</span>
<span class="n">npl</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
          <span class="n">rc</span><span class="o">=</span><span class="p">({</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> 
               <span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> 
               <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;legend.fontsize&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> 
               <span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
               <span class="s1">&#39;xtick.direction&#39;</span><span class="p">:</span> <span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="s1">&#39;ytick.direction&#39;</span><span class="p">:</span> <span class="s1">&#39;out&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;xtick.major.size&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ytick.major.size&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
               <span class="s1">&#39;pdf.fonttype&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="s1">&#39;ps.fonttype&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
               
               <span class="c1"># --- MANUSCRIPT MODE OVERRIDES ---</span>
               <span class="s1">&#39;figure.facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span>  <span class="c1"># Transparent background</span>
               <span class="s1">&#39;axes.facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span>    <span class="c1"># Transparent axes</span>
               <span class="s1">&#39;savefig.facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="c1"># Transparent on save</span>
               
               <span class="s1">&#39;text.color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>       <span class="c1"># Black Text</span>
               <span class="s1">&#39;axes.labelcolor&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>  <span class="c1"># Black Axis Labels</span>
               <span class="s1">&#39;xtick.color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>      <span class="c1"># Black Ticks</span>
               <span class="s1">&#39;ytick.color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>      <span class="c1"># Black Ticks</span>
               <span class="s1">&#39;axes.edgecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>   <span class="c1"># Black Spines</span>
               
               <span class="s1">&#39;legend.facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span>  <span class="c1"># Transparent Legend</span>
               <span class="s1">&#39;legend.edgecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span>  <span class="c1"># No border on legend</span>
               <span class="s1">&#39;legend.labelcolor&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span> <span class="c1"># Black Legend Text</span>
               <span class="p">}))</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="c1"># Set the root logger&#39;s level to ERROR to suppress WARNING messages</span>
<span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">setLevel</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">ERROR</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">wilcoxon</span><span class="p">,</span> <span class="n">theilslopes</span><span class="p">,</span> <span class="n">mannwhitneyu</span>

<span class="k">def</span> <span class="nf">get_stars</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;***&#39;</span>
    <span class="k">elif</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;**&#39;</span>
    <span class="k">elif</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;*&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;ns&#39;</span>

<span class="k">def</span> <span class="nf">format_pvalue</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">:</span> <span class="k">return</span> <span class="s2">&quot;p &lt; 0.001&quot;</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;p = </span><span class="si">{</span><span class="n">p</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_learning_stats</span><span class="p">(</span><span class="n">data_list</span><span class="p">,</span> <span class="n">save_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Training days&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Success rate (%)&quot;</span><span class="p">,</span> <span class="n">colormapping</span> <span class="o">=</span> <span class="s2">&quot;#8da3a3ff&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots mean +/- SEM.</span>
<span class="sd">    Statistical Test: </span>
<span class="sd">    1. Calculates Theil-Sen slope (robust non-parametric trend) for EACH animal across the 7 days.</span>
<span class="sd">       This collapses the repeated measures into a single &#39;improvement rate&#39; per animal.</span>
<span class="sd">    2. Performs a One-Sample Wilcoxon Signed-Rank Test on these slopes against 0.</span>
<span class="sd">       (Alternative=&#39;greater&#39; tests if the median slope is positive, i.e., improvement).</span>
<span class="sd">       </span>
<span class="sd">    This avoids mixed-effects confounding by treating the animal as the unit of analysis</span>
<span class="sd">    and analyzing the distribution of their individual trends.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># 1. Calculate Robust Slopes for each animal</span>
    <span class="n">slopes</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">days</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span> <span class="c1"># Days 1-7</span>
    
    <span class="k">for</span> <span class="n">mouse_data</span> <span class="ow">in</span> <span class="n">data_list</span><span class="p">:</span>
        <span class="c1"># Handle NaNs if any (require at least 2 points)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">mouse_data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="c1"># theilslopes returns (slope, intercept, low, high)</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">theilslopes</span><span class="p">(</span><span class="n">mouse_data</span><span class="p">[</span><span class="n">mask</span><span class="p">],</span> <span class="n">days</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span>
            <span class="n">slopes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            
    <span class="c1"># 2. Statistical Comparison (Do slopes consistently indicate improvement &gt; 0?)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># We test if the distribution of slopes is symmetric around a value &gt; 0</span>
        <span class="n">stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">wilcoxon</span><span class="p">(</span><span class="n">slopes</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;greater&#39;</span><span class="p">)</span>
        <span class="n">significance_text</span> <span class="o">=</span> <span class="n">get_stars</span><span class="p">(</span><span class="n">p_value</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">p_value</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">significance_text</span> <span class="o">=</span> <span class="s1">&#39;ns&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Warning: Statistical test failed (insufficient data).&quot;</span><span class="p">)</span>

    <span class="c1"># 3. Calculate Group Mean and SEM for plotting</span>
    <span class="n">data_matrix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">data_list</span><span class="p">)</span>
    <span class="n">mean_trace</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sem_trace</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanstd</span><span class="p">(</span><span class="n">data_matrix</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">data_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># 4. Plotting Setup</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">lw</span> <span class="o">=</span> <span class="mf">1.33</span>

    <span class="c1"># 5. Errorbar Plot</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">days</span><span class="p">,</span> <span class="n">mean_trace</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">sem_trace</span><span class="p">,</span> 
                <span class="n">color</span><span class="o">=</span><span class="n">colormapping</span><span class="p">,</span>
                <span class="n">ecolor</span><span class="o">=</span><span class="n">colormapping</span><span class="p">,</span>
                <span class="n">linewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span>
                <span class="n">elinewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span>
                <span class="n">markeredgewidth</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span>
                
                <span class="n">capsize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
                <span class="n">capthick</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Group Mean&#39;</span><span class="p">)</span>

    <span class="c1"># 6. Add Significance Bracket</span>
    <span class="c1"># Bracket spans the full 7 days to indicate &quot;Trend Analysis&quot;</span>
    <span class="n">y_max_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">mean_trace</span> <span class="o">+</span> <span class="n">sem_trace</span><span class="p">)</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span>
    <span class="n">y_start</span> <span class="o">=</span> <span class="n">y_max_data</span> <span class="o">+</span> <span class="mi">5</span>
    <span class="n">h</span> <span class="o">=</span> <span class="mi">2</span> 

    <span class="c1"># Draw bracket</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x1</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">,</span> <span class="n">x2</span><span class="p">],</span> <span class="p">[</span><span class="n">y_start</span><span class="p">,</span> <span class="n">y_start</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">y_start</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">y_start</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="p">)</span><span class="o">*</span><span class="mf">.5</span><span class="p">,</span> <span class="n">y_start</span><span class="o">+</span><span class="n">h</span><span class="p">,</span> <span class="n">significance_text</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

    <span class="c1"># 7. Aesthetics</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
    
    <span class="c1"># Enforce axis limits</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">days</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">save_filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_filename</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trend Analysis Result (Median Slope &gt; 0): p-value=</span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.5f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_retraining_comparison</span><span class="p">(</span><span class="n">all_mice_data</span><span class="p">,</span> <span class="n">colour</span><span class="p">,</span> <span class="n">animal_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">save_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plots paired Day 1 vs Day 7 retraining data.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    - all_mice_data: Dictionary {mouse_name: array_of_scores_in_decimals}</span>
<span class="sd">    - animal_names: List of keys to filter. If None, uses all keys in dict.</span>
<span class="sd">    - save_filename: String path to save PDF. If None, does not save.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="c1"># --- 1. Filter Data ---</span>
    <span class="k">if</span> <span class="n">animal_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Use all animals if no list provided</span>
        <span class="n">animal_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_mice_data</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">filtered_data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_mice_data</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Filter based on provided list</span>
        <span class="n">filtered_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">valid_names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">animal_names</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">all_mice_data</span><span class="p">:</span>
                <span class="n">filtered_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">all_mice_data</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
                <span class="n">valid_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> not found in provided data dictionary.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">filtered_data</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No valid data found to plot.&quot;</span><span class="p">)</span>
            <span class="k">return</span>

    <span class="c1"># --- 2. Extract Data (Day 1 vs Day 7) ---</span>
    <span class="c1"># Assuming input data is 0.0-1.0 decimals based on your usage of *100 later</span>
    <span class="n">day1_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">filtered_data</span><span class="p">]</span>
    <span class="n">day7_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">filtered_data</span><span class="p">]</span>

    <span class="c1"># --- 3. Plotting Setup ---</span>
    <span class="n">npl</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
          <span class="n">rc</span><span class="o">=</span><span class="p">({</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
               <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span><span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;legend.fontsize&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
               <span class="s1">&#39;pdf.fonttype&#39;</span><span class="p">:</span><span class="mi">42</span><span class="p">,</span> <span class="s1">&#39;ps.fonttype&#39;</span><span class="p">:</span><span class="mi">42</span><span class="p">,}))</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">x_positions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
    
    <span class="c1"># --- 4. Plot Individual Pairs ---</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">day1_scores</span><span class="p">)):</span>
        <span class="c1"># Convert to percentage for plotting</span>
        <span class="n">d1_percent</span> <span class="o">=</span> <span class="n">day1_scores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">d7_percent</span> <span class="o">=</span> <span class="n">day7_scores</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_positions</span><span class="p">,</span> <span class="p">[</span><span class="n">d1_percent</span><span class="p">,</span> <span class="n">d7_percent</span><span class="p">],</span> 
                <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> 
                <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>                                    <span class="c1"># Black connecting line</span>
                <span class="n">markerfacecolor</span><span class="o">=</span><span class="n">colour</span><span class="p">,</span> 
                <span class="n">markeredgecolor</span><span class="o">=</span><span class="n">colour</span><span class="p">,</span> 
                <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> 
                <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> 
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>

    <span class="c1"># --- 5. Statistics (Wilcoxon) ---</span>
    <span class="n">day1_percent_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">day1_scores</span><span class="p">]</span>
    <span class="n">day7_percent_scores</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">day7_scores</span><span class="p">]</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="n">stat</span><span class="p">,</span> <span class="n">pvalue</span> <span class="o">=</span> <span class="n">wilcoxon</span><span class="p">(</span><span class="n">day1_percent_scores</span><span class="p">,</span> <span class="n">day7_percent_scores</span><span class="p">)</span>
        <span class="n">stars</span> <span class="o">=</span> <span class="n">get_stars</span><span class="p">(</span><span class="n">pvalue</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pvalue</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">:</span>
            <span class="n">p_text</span> <span class="o">=</span> <span class="s2">&quot;p &lt; 0.001&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">p_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;p = </span><span class="si">{</span><span class="n">pvalue</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">stars</span> <span class="o">=</span> <span class="s1">&#39;ns&#39;</span>
        <span class="n">p_text</span> <span class="o">=</span> <span class="s1">&#39;ns&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Wilcoxon test could not be run (likely insufficient data).&quot;</span><span class="p">)</span>

    <span class="c1"># --- 6. Significance Bracket ---</span>
    <span class="n">x_mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_positions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_positions</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">y_bar</span> <span class="o">=</span> <span class="mi">74</span>  
    <span class="n">y_star</span> <span class="o">=</span> <span class="mi">75</span> 
    <span class="n">y_pvalue</span> <span class="o">=</span> <span class="mi">78</span> 

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x_positions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_positions</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">y_bar</span><span class="p">,</span> <span class="n">y_bar</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x_positions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_positions</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">y_bar</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y_bar</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x_positions</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x_positions</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">y_bar</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y_bar</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_mid</span><span class="p">,</span> <span class="n">y_star</span><span class="p">,</span> <span class="n">stars</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_mid</span><span class="p">,</span> <span class="n">y_pvalue</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p_text</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># --- 7. Aesthetics ---</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">x_positions</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="s1">&#39;7&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Retrieval (days)&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Success rate (%)&quot;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">80</span><span class="p">])</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s1">&#39;out&#39;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    
    <span class="c1"># --- 8. Save Logic ---</span>
    <span class="k">if</span> <span class="n">save_filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_filename</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Figure saved to </span><span class="si">{</span><span class="n">save_filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="panel-a-experimental-timeline">
<h2>Panel a (Experimental Timeline)<a class="headerlink" href="#panel-a-experimental-timeline" title="Permalink to this heading">#</a></h2>
<p><img alt="Figure 7 Panel A" src="_images/panelA1.svg" />
Experimental timeline with retrieval intervention 10 weeks after the end of the initial learning period.</p>
</section>
<section id="panel-b-long-term-functional-recovery">
<h2>Panel b: (Long-Term Functional Recovery)<a class="headerlink" href="#panel-b-long-term-functional-recovery" title="Permalink to this heading">#</a></h2>
<p><strong>Long-term motor performance during retrieval.</strong> Mice were re-tested on the skilled reach task 10 weeks after the initial learning phase (days 77-84 post-cuprizone) to assess long-term functional recovery. No VNS stimulation was delivered during this retrieval period.</p>
<ul class="simple">
<li><p><strong>Motor Learning (Control):</strong> Mice exhibited a plateau in performance, failing to show significant improvement across the 7-day retrieval session.</p></li>
<li><p><strong>Paired VNS:</strong> Mice demonstrated robust re-acquisition of motor skills, with significant improvement across the retrieval session, suggesting enhanced long-term consolidation.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load motor learning data</span>
<span class="n">mobp14_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">23.958333333</span><span class="p">,</span>
<span class="mf">16.666666667</span><span class="p">,</span>
<span class="mf">30.120481928</span><span class="p">,</span>
<span class="mf">28.155339806</span><span class="p">,</span>
<span class="mf">59.677419355</span><span class="p">,</span>
<span class="mf">46.052631579</span><span class="p">,</span>
<span class="mf">40.243902439</span>
<span class="p">])</span>
<span class="n">mobp20_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">27.777777778</span><span class="p">,</span>
<span class="mf">35.087719298</span><span class="p">,</span>
<span class="mf">25.742574257</span><span class="p">,</span>
<span class="mi">30</span><span class="p">,</span>
<span class="mf">39.56043956</span><span class="p">,</span>
<span class="mf">33.333333333</span><span class="p">,</span>
<span class="mf">49.295774648</span>
<span class="p">])</span>
<span class="n">mobp27_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">26.785714286</span><span class="p">,</span>
<span class="mf">34.146341463</span><span class="p">,</span>
<span class="mf">28.787878788</span><span class="p">,</span>
<span class="mf">32.307692308</span><span class="p">,</span>
<span class="mf">23.863636364</span><span class="p">,</span>
<span class="mf">43.28358209</span><span class="p">,</span>
<span class="mf">39.344262295</span>
<span class="p">])</span>
<span class="n">mobp28_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">27.941176471</span><span class="p">,</span>
<span class="mf">29.268292683</span><span class="p">,</span>
<span class="mf">24.657534247</span><span class="p">,</span>
<span class="mf">18.181818182</span><span class="p">,</span>
<span class="mf">26.923076923</span><span class="p">,</span>
<span class="mf">27.142857143</span><span class="p">,</span>
<span class="mf">26.25</span>
<span class="p">])</span>
<span class="n">mobp32_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">13.75</span><span class="p">,</span>
<span class="mf">25.757575758</span><span class="p">,</span>
<span class="mf">33.870967742</span><span class="p">,</span>
<span class="mi">20</span><span class="p">,</span>
<span class="mf">38.805970149</span><span class="p">,</span>
<span class="mf">42.253521127</span><span class="p">,</span>
<span class="mi">28</span>
<span class="p">])</span>
<span class="n">mobp34_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">19.642857143</span><span class="p">,</span>
<span class="mi">45</span><span class="p">,</span>
<span class="mf">31.481481481</span><span class="p">,</span>
<span class="mf">10.95890411</span><span class="p">,</span>
<span class="mf">30.952380952</span><span class="p">,</span>
<span class="mf">22.222222222</span><span class="p">,</span>
<span class="mf">31.746031746</span>
<span class="p">])</span>
<span class="n">mobp35_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">35.294117647</span><span class="p">,</span>
<span class="mf">38.983050847</span><span class="p">,</span>
<span class="mf">41.095890411</span><span class="p">,</span>
<span class="mf">33.783783784</span><span class="p">,</span>
<span class="mf">29.05982906</span><span class="p">,</span>
<span class="mf">34.920634921</span><span class="p">,</span>
<span class="mf">37.037037037</span>
<span class="p">])</span>
<span class="n">mobp112_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.05454545455</span><span class="p">,</span>
<span class="mf">0.2222222222</span><span class="p">,</span>
<span class="mf">0.14</span><span class="p">,</span>
<span class="mf">0.106557377</span><span class="p">,</span>
<span class="mf">0.2289156627</span><span class="p">,</span>
<span class="mf">0.1610169492</span><span class="p">,</span>
<span class="mf">0.3725490196</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp120_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.4054054054</span><span class="p">,</span>
<span class="mf">0.4117647059</span><span class="p">,</span>
<span class="mf">0.1549295775</span><span class="p">,</span>
<span class="mf">0.328358209</span><span class="p">,</span>
<span class="mf">0.3424657534</span><span class="p">,</span>
<span class="mf">0.3428571429</span><span class="p">,</span>
<span class="mf">0.1641791045</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp121_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.2258064516</span><span class="p">,</span>
<span class="mf">0.1168831169</span><span class="p">,</span>
<span class="mf">0.3833333333</span><span class="p">,</span>
<span class="mf">0.1176470588</span><span class="p">,</span>
<span class="mf">0.1018518519</span><span class="p">,</span>
<span class="mf">0.04166666667</span><span class="p">,</span>
<span class="mf">0.253968254</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp150_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.5531914894</span><span class="p">,</span>
<span class="mf">0.6274509804</span><span class="p">,</span>
<span class="mf">0.44</span><span class="p">,</span>
<span class="mf">0.3333333333</span><span class="p">,</span>
<span class="mf">0.3125</span><span class="p">,</span>
<span class="mf">0.375</span><span class="p">,</span>
<span class="mf">0.3692307692</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp157_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.3333333333</span><span class="p">,</span>
<span class="mf">0.3833333333</span><span class="p">,</span>
<span class="mf">0.347826087</span><span class="p">,</span>
<span class="mf">0.4893617021</span><span class="p">,</span>
<span class="mf">0.4038461538</span><span class="p">,</span>
<span class="mf">0.32</span><span class="p">,</span>
<span class="mf">0.5625</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>

<span class="n">motorlearning_learning</span> <span class="o">=</span> <span class="p">[</span><span class="n">mobp14_successrates</span><span class="p">,</span>
<span class="n">mobp20_successrates</span><span class="p">,</span>
<span class="n">mobp27_successrates</span><span class="p">,</span>
<span class="n">mobp28_successrates</span><span class="p">,</span>
<span class="n">mobp32_successrates</span><span class="p">,</span>
<span class="n">mobp34_successrates</span><span class="p">,</span>
<span class="n">mobp35_successrates</span><span class="p">,</span>
<span class="n">mobp112_successrates</span><span class="p">,</span>
<span class="n">mobp120_successrates</span><span class="p">,</span>
<span class="n">mobp121_successrates</span><span class="p">,</span>
<span class="n">mobp150_successrates</span><span class="p">,</span>
<span class="n">mobp157_successrates</span><span class="p">]</span>

<span class="n">mobp14_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">.26470588235</span><span class="p">,</span>
<span class="mf">.083333333333</span><span class="p">,</span>
<span class="mf">.18055555556</span><span class="p">,</span>
<span class="mf">.23529411765</span><span class="p">,</span>
<span class="mf">.28947368421</span><span class="p">,</span>
<span class="mf">.28571428571</span><span class="p">,</span>
<span class="mf">.27027027027</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp20_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.2098765432</span><span class="p">,</span>
<span class="mf">0.196969697</span><span class="p">,</span>
<span class="mf">0.3291139241</span><span class="p">,</span>
<span class="mf">0.525</span><span class="p">,</span>
<span class="mf">0.34375</span><span class="p">,</span>
<span class="mf">0.4342105263</span><span class="p">,</span>
<span class="mf">0.3766233766</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp27_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.4901960784</span><span class="p">,</span>
<span class="mf">0.3880597015</span><span class="p">,</span>
<span class="mf">0.3604651163</span><span class="p">,</span>
<span class="mf">0.4714285714</span><span class="p">,</span>
<span class="mf">0.4594594595</span><span class="p">,</span>
<span class="mf">0.4810126582</span><span class="p">,</span>
<span class="mf">0.5666666667</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp28_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.2894736842</span><span class="p">,</span>
<span class="mf">0.2727272727</span><span class="p">,</span>
<span class="mf">0.4166666667</span><span class="p">,</span>
<span class="mf">0.4166666667</span><span class="p">,</span>
<span class="mf">0.3823529412</span><span class="p">,</span>
<span class="mf">0.4545454545</span><span class="p">,</span>
<span class="mf">0.3898305085</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp32_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">.4347826087</span><span class="p">,</span>
<span class="mf">.35185185185</span><span class="p">,</span>
<span class="mf">.26153846154</span><span class="p">,</span>
<span class="mf">.32307692308</span><span class="p">,</span>
<span class="mf">.27941176471</span><span class="p">,</span>
<span class="mf">.28947368421</span><span class="p">,</span>
<span class="mf">.28947368421</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp34_retrainng_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.5384615385</span><span class="p">,</span>
<span class="mf">0.3902439024</span><span class="p">,</span>
<span class="mf">0.5652173913</span><span class="p">,</span>
<span class="mf">0.5384615385</span><span class="p">,</span>
<span class="mf">0.3846153846</span><span class="p">,</span>
<span class="mf">0.5294117647</span><span class="p">,</span>
<span class="mf">0.48</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp35_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.2295081967</span><span class="p">,</span>
<span class="mf">0.3492063492</span><span class="p">,</span>
<span class="mf">0.262295082</span><span class="p">,</span>
<span class="mf">0.3857142857</span><span class="p">,</span>
<span class="mf">0.3820224719</span><span class="p">,</span>
<span class="mf">0.3076923077</span><span class="p">,</span>
<span class="mf">0.4722222222</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp112_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.07692307692</span><span class="p">,</span>
<span class="mf">0.1145833333</span><span class="p">,</span>
<span class="mf">0.1298701299</span><span class="p">,</span>
<span class="mf">0.01724137931</span><span class="p">,</span>
<span class="mf">0.1780821918</span><span class="p">,</span>
<span class="mf">0.07920792079</span><span class="p">,</span>
<span class="mf">0.171875</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp120_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.01515151515</span><span class="p">,</span>
<span class="mf">0.1704545455</span><span class="p">,</span>
<span class="mf">0.03592814371</span><span class="p">,</span>
<span class="mf">0.2769230769</span><span class="p">,</span>
<span class="mf">0.3552631579</span><span class="p">,</span>
<span class="mf">0.2068965517</span><span class="p">,</span>
<span class="mf">0.1941747573</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp121_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span>
<span class="mi">0</span><span class="p">,</span>
<span class="mf">0.1168831169</span><span class="p">,</span>
<span class="mf">0.07142857143</span><span class="p">,</span>
<span class="mf">0.1714285714</span><span class="p">,</span>
<span class="mf">0.1449275362</span><span class="p">,</span>
<span class="mf">0.2272727273</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp150_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.5223880597</span><span class="p">,</span>
<span class="mf">0.3333333333</span><span class="p">,</span>
<span class="mf">0.3857142857</span><span class="p">,</span>
<span class="mf">0.4193548387</span><span class="p">,</span>
<span class="mf">0.3636363636</span><span class="p">,</span>
<span class="mf">0.2676056338</span><span class="p">,</span>
<span class="mf">0.3650793651</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp157_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.1785714286</span><span class="p">,</span>
<span class="mf">0.2686567164</span><span class="p">,</span>
<span class="mf">0.1764705882</span><span class="p">,</span>
<span class="mf">0.1923076923</span><span class="p">,</span>
<span class="mf">0.2571428571</span><span class="p">,</span>
<span class="mf">0.2222222222</span><span class="p">,</span>
<span class="mf">0.3333333333</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">motorlearning_retraining</span> <span class="o">=</span> <span class="p">[</span><span class="n">mobp14_retraining_successrates</span><span class="p">,</span>
<span class="n">mobp20_retraining_successrates</span><span class="p">,</span>
<span class="n">mobp27_retraining_successrates</span><span class="p">,</span>
<span class="n">mobp28_retraining_successrates</span><span class="p">,</span>
<span class="n">mobp32_retraining_successrates</span><span class="p">,</span>
<span class="n">mobp34_retrainng_successrates</span><span class="p">,</span>
<span class="n">mobp35_retraining_successrates</span><span class="p">,</span>
<span class="n">mobp112_retraining_successrates</span><span class="p">,</span>
<span class="n">mobp120_retraining_successrates</span><span class="p">,</span>
<span class="n">mobp121_retraining_successrates</span><span class="p">,</span>
<span class="n">mobp150_retraining_successrates</span><span class="p">,</span>
<span class="n">mobp157_retraining_successrates</span><span class="p">]</span>
<span class="n">all_mice_data_motorlearning_learning</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;mobp14&#39;</span><span class="p">:</span> <span class="n">mobp14_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp20&#39;</span><span class="p">:</span> <span class="n">mobp20_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp27&#39;</span><span class="p">:</span> <span class="n">mobp27_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp28&#39;</span><span class="p">:</span> <span class="n">mobp28_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp32&#39;</span><span class="p">:</span> <span class="n">mobp32_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp34&#39;</span><span class="p">:</span> <span class="n">mobp34_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp35&#39;</span><span class="p">:</span> <span class="n">mobp35_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp112&#39;</span><span class="p">:</span> <span class="n">mobp112_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp120&#39;</span><span class="p">:</span> <span class="n">mobp120_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp121&#39;</span><span class="p">:</span> <span class="n">mobp121_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp150&#39;</span><span class="p">:</span> <span class="n">mobp150_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp157&#39;</span><span class="p">:</span> <span class="n">mobp157_successrates</span>
<span class="p">}</span>

<span class="n">all_mice_data_motorlearning_retraining</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;mobp14&#39;</span><span class="p">:</span> <span class="n">mobp14_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp20&#39;</span><span class="p">:</span> <span class="n">mobp20_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp27&#39;</span><span class="p">:</span> <span class="n">mobp27_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp28&#39;</span><span class="p">:</span> <span class="n">mobp28_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp32&#39;</span><span class="p">:</span> <span class="n">mobp32_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp34&#39;</span><span class="p">:</span> <span class="n">mobp34_retrainng_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp35&#39;</span><span class="p">:</span> <span class="n">mobp35_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp112&#39;</span><span class="p">:</span> <span class="n">mobp112_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp120&#39;</span><span class="p">:</span> <span class="n">mobp120_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp121&#39;</span><span class="p">:</span> <span class="n">mobp121_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp150&#39;</span><span class="p">:</span> <span class="n">mobp150_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp157&#39;</span><span class="p">:</span> <span class="n">mobp157_retraining_successrates</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load paired vns data</span>
<span class="n">mobp16_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.3815789474</span><span class="p">,</span>
<span class="mf">0.5</span><span class="p">,</span>
<span class="mf">0.3287671233</span><span class="p">,</span>
<span class="mf">0.2924528302</span><span class="p">,</span>
<span class="mf">0.2298850575</span><span class="p">,</span>
<span class="mf">0.4197530864</span><span class="p">,</span>
<span class="mf">0.5769230769</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp17_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.2878787879</span><span class="p">,</span>
<span class="mf">0.1724137931</span><span class="p">,</span>
<span class="mf">0.5238095238</span><span class="p">,</span>
<span class="mf">0.3866666667</span><span class="p">,</span>
<span class="mf">0.36</span><span class="p">,</span>
<span class="mf">0.3333333333</span><span class="p">,</span>
<span class="mf">0.2843137255</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobpp18_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">16.666666667</span><span class="p">,</span>
<span class="mf">27.083333333</span><span class="p">,</span>
<span class="mf">18.75</span><span class="p">,</span>
<span class="mi">20</span><span class="p">,</span>
<span class="mf">27.419354839</span><span class="p">,</span>
<span class="mf">17.475728155</span><span class="p">,</span>
<span class="mf">24.324324324</span>
<span class="p">])</span>
<span class="n">mobp19_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">35.416666667</span><span class="p">,</span>
<span class="mi">45</span><span class="p">,</span>
<span class="mf">31.034482759</span><span class="p">,</span>
<span class="mf">45.945945946</span><span class="p">,</span>
<span class="mf">47.058823529</span><span class="p">,</span>
<span class="mf">37.931034483</span><span class="p">,</span>
<span class="mf">34.722222222</span>
<span class="p">])</span>
<span class="n">mobp29_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">18.461538462</span><span class="p">,</span>
<span class="mf">41.025641026</span><span class="p">,</span>
<span class="mf">27.692307692</span><span class="p">,</span>
<span class="mf">28.571428571</span><span class="p">,</span>
<span class="mf">29.761904762</span><span class="p">,</span>
<span class="mi">60</span><span class="p">,</span>
<span class="mf">69.444444444</span>
<span class="p">])</span>
<span class="n">mobp30_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">31.25</span><span class="p">,</span>
<span class="mf">37.931034483</span><span class="p">,</span>
<span class="mf">33.333333333</span><span class="p">,</span>
<span class="mf">27.586206897</span><span class="p">,</span>
<span class="mf">19.298245614</span><span class="p">,</span>
<span class="mf">19.101123596</span><span class="p">,</span>
<span class="mf">33.333333333</span>
<span class="p">])</span>
<span class="n">mobp31_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">21.739130435</span><span class="p">,</span>
<span class="mf">24.324324324</span><span class="p">,</span>
<span class="mf">22.535211268</span><span class="p">,</span>
<span class="mf">26.086956522</span><span class="p">,</span>
<span class="mf">40.048679434</span><span class="p">,</span>
<span class="mf">50.546879453</span><span class="p">,</span>
<span class="mf">52.315498234</span>
<span class="p">])</span>
<span class="n">mobp33_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">48.275862069</span><span class="p">,</span>
<span class="mf">54.838709677</span><span class="p">,</span>
<span class="mf">46.666666667</span><span class="p">,</span>
<span class="mf">40.425531915</span><span class="p">,</span>
<span class="mi">50</span><span class="p">,</span>
<span class="mf">52.542372881</span><span class="p">,</span>
<span class="mf">54.166666667</span>
<span class="p">])</span>
<span class="n">mobp111_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.4047619048</span><span class="p">,</span>
<span class="mf">0.7307692308</span><span class="p">,</span>
<span class="mf">0.4358974359</span><span class="p">,</span>
<span class="mf">0.4285714286</span><span class="p">,</span>
<span class="mf">0.5087719298</span><span class="p">,</span>
<span class="mf">0.4444444444</span><span class="p">,</span>
<span class="mf">0.5762711864</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">pairedVNS_learning</span> <span class="o">=</span> <span class="p">[</span><span class="n">mobp16_successrates</span><span class="p">,</span>
<span class="n">mobp17_successrates</span><span class="p">,</span>
<span class="n">mobpp18_successrates</span><span class="p">,</span>
<span class="n">mobp19_successrates</span><span class="p">,</span>
<span class="n">mobp29_successrates</span><span class="p">,</span>
<span class="n">mobp30_successrates</span><span class="p">,</span>
<span class="n">mobp31_successrates</span><span class="p">,</span>
<span class="n">mobp33_successrates</span><span class="p">,</span>
<span class="n">mobp111_successrates</span><span class="p">]</span>

<span class="n">mobp16_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.275862069</span><span class="p">,</span>
<span class="mf">0.4871794872</span><span class="p">,</span>
<span class="mf">0.3214285714</span><span class="p">,</span>
<span class="mf">0.4042553191</span><span class="p">,</span>
<span class="mf">0.3214285714</span><span class="p">,</span>
<span class="mf">0.328358209</span><span class="p">,</span>
<span class="mf">0.5230769231</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp17_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.2025316456</span><span class="p">,</span>
<span class="mf">0.1607142857</span><span class="p">,</span>
<span class="mf">0.1171171171</span><span class="p">,</span>
<span class="mf">0.2524271845</span><span class="p">,</span>
<span class="mf">0.2459016393</span><span class="p">,</span>
<span class="mf">0.22</span><span class="p">,</span>
<span class="mf">0.2894736842</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobpp18_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">.20481927711</span><span class="p">,</span>
<span class="mf">.30555555556</span><span class="p">,</span>
<span class="mf">.27722772277</span><span class="p">,</span>
<span class="mf">.17391304348</span><span class="p">,</span>
<span class="mf">.10833333333</span><span class="p">,</span>
<span class="mf">.21739130435</span><span class="p">,</span>
<span class="mf">.37333333333</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp19_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">.41463414634</span><span class="p">,</span>
<span class="mf">.45098039216</span><span class="p">,</span>
<span class="mf">.53333333333</span><span class="p">,</span>
<span class="mf">.60465116279</span><span class="p">,</span>
<span class="mf">.51020408163</span><span class="p">,</span>
<span class="mf">.55172413793</span><span class="p">,</span>
<span class="mf">.50</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp29_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.5142857143</span><span class="p">,</span>
<span class="mf">0.4166666667</span><span class="p">,</span>
<span class="mf">0.5277777778</span><span class="p">,</span>
<span class="mf">0.6071428571</span><span class="p">,</span>
<span class="mf">0.4565217391</span><span class="p">,</span>
<span class="mf">0.6</span><span class="p">,</span>
<span class="mf">0.6875</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp30_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.32352941176</span><span class="p">,</span>
<span class="mf">.50</span><span class="p">,</span>
<span class="mf">.33333333333</span><span class="p">,</span>
<span class="mf">.40540540541</span><span class="p">,</span>
<span class="mf">.58064516129</span><span class="p">,</span>
<span class="mf">.43396226415</span><span class="p">,</span>
<span class="mf">.65</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp31_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">.25925925926</span><span class="p">,</span>
<span class="mf">.2641509434</span><span class="p">,</span>
<span class="mf">.27659574468</span><span class="p">,</span>
<span class="mf">.36363636364</span><span class="p">,</span>
<span class="mf">.27777777778</span><span class="p">,</span>
<span class="mf">.16</span><span class="p">,</span>
<span class="mf">.3275862069</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp33_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.6</span><span class="p">,</span>
<span class="mf">0.5454545455</span><span class="p">,</span>
<span class="mf">0.6153846154</span><span class="p">,</span>
<span class="mf">0.5454545455</span><span class="p">,</span>
<span class="mf">0.4444444444</span><span class="p">,</span>
<span class="mf">0.5</span><span class="p">,</span>
<span class="mf">0.5769230769</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">mobp111_retraining_successrates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="mf">0.32</span><span class="p">,</span>
<span class="mf">0.4150943396</span><span class="p">,</span>
<span class="mf">0.4444444444</span><span class="p">,</span>
<span class="mf">0.4264705882</span><span class="p">,</span>
<span class="mf">0.4788732394</span><span class="p">,</span>
<span class="mf">0.5</span><span class="p">,</span>
<span class="mf">0.3770491803</span><span class="p">])</span><span class="o">*</span><span class="mi">100</span>
<span class="n">pairedVNS_retraining</span> <span class="o">=</span> <span class="p">[</span><span class="n">mobp16_retraining_successrates</span><span class="p">,</span>
<span class="n">mobp17_retraining_successrates</span><span class="p">,</span>
<span class="n">mobpp18_retraining_successrates</span><span class="p">,</span>
<span class="n">mobp19_retraining_successrates</span><span class="p">,</span>
<span class="n">mobp29_retraining_successrates</span><span class="p">,</span>
<span class="n">mobp30_retraining_successrates</span><span class="p">,</span>
<span class="n">mobp31_retraining_successrates</span><span class="p">,</span>
<span class="n">mobp33_retraining_successrates</span><span class="p">,</span>
<span class="n">mobp111_retraining_successrates</span><span class="p">]</span>

<span class="n">all_mice_data_pairedVNS_learning</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;mobp16&#39;</span><span class="p">:</span> <span class="n">mobp16_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp17&#39;</span><span class="p">:</span> <span class="n">mobp17_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp18&#39;</span><span class="p">:</span> <span class="n">mobpp18_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp19&#39;</span><span class="p">:</span> <span class="n">mobp19_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp29&#39;</span><span class="p">:</span> <span class="n">mobp29_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp30&#39;</span><span class="p">:</span> <span class="n">mobp30_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp31&#39;</span><span class="p">:</span> <span class="n">mobp31_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp33&#39;</span><span class="p">:</span> <span class="n">mobp33_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp111&#39;</span><span class="p">:</span> <span class="n">mobp111_successrates</span>
<span class="p">}</span>

<span class="n">all_mice_data_pairedVNS_retraining</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;mobp16&#39;</span><span class="p">:</span> <span class="n">mobp16_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp17&#39;</span><span class="p">:</span> <span class="n">mobp17_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp18&#39;</span><span class="p">:</span> <span class="n">mobpp18_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp19&#39;</span><span class="p">:</span> <span class="n">mobp19_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp29&#39;</span><span class="p">:</span> <span class="n">mobp29_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp30&#39;</span><span class="p">:</span> <span class="n">mobp30_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp31&#39;</span><span class="p">:</span> <span class="n">mobp31_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp33&#39;</span><span class="p">:</span> <span class="n">mobp33_retraining_successrates</span><span class="p">,</span>
    <span class="s1">&#39;mobp111&#39;</span><span class="p">:</span> <span class="n">mobp111_retraining_successrates</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_learning_stats</span><span class="p">(</span><span class="n">motorlearning_learning</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Training days&quot;</span><span class="p">,</span> <span class="s2">&quot;Success rate (%)&quot;</span><span class="p">,</span> <span class="n">colormapping</span> <span class="o">=</span> <span class="s2">&quot;#8da3a3ff&quot;</span><span class="p">)</span>
<span class="n">plot_learning_stats</span><span class="p">(</span><span class="n">motorlearning_retraining</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Retraining (days)&quot;</span><span class="p">,</span> <span class="s2">&quot;Success rate (%)&quot;</span><span class="p">,</span> <span class="n">colormapping</span> <span class="o">=</span> <span class="s2">&quot;#8da3a3ff&quot;</span><span class="p">)</span>
<span class="n">plot_retraining_comparison</span><span class="p">(</span><span class="n">all_mice_data_motorlearning_retraining</span><span class="p">,</span> <span class="n">colour</span><span class="o">=</span><span class="s1">&#39;#8da3a3ff&#39;</span><span class="p">,</span> <span class="n">save_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/2d7e46986ca2fbbbebd1a6afe9f46c6965dd94d26bbc2c24200d786855c7e3ff.png" src="_images/2d7e46986ca2fbbbebd1a6afe9f46c6965dd94d26bbc2c24200d786855c7e3ff.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trend Analysis Result (Median Slope &gt; 0): p-value=0.15063
</pre></div>
</div>
<img alt="_images/adc79ce09e617fe1033f1615d876ce709e6ada2762dd334d28962b1d7ecf2552.png" src="_images/adc79ce09e617fe1033f1615d876ce709e6ada2762dd334d28962b1d7ecf2552.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trend Analysis Result (Median Slope &gt; 0): p-value=0.01050
</pre></div>
</div>
<img alt="_images/1a0edf9911a76cd3e52e3d211007b3143679824aeb775bf715367f723ac2fdd5.png" src="_images/1a0edf9911a76cd3e52e3d211007b3143679824aeb775bf715367f723ac2fdd5.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_learning_stats</span><span class="p">(</span><span class="n">pairedVNS_learning</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Training (days)&quot;</span><span class="p">,</span> <span class="s2">&quot;Success rate (%)&quot;</span><span class="p">,</span> <span class="n">colormapping</span> <span class="o">=</span> <span class="s2">&quot;#0a60ffff&quot;</span><span class="p">)</span>
<span class="n">plot_learning_stats</span><span class="p">(</span><span class="n">pairedVNS_retraining</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Retraining (days)&quot;</span><span class="p">,</span> <span class="s2">&quot;Success rate (%)&quot;</span><span class="p">,</span> <span class="n">colormapping</span> <span class="o">=</span> <span class="s2">&quot;#0a60ffff&quot;</span><span class="p">)</span>
<span class="n">plot_retraining_comparison</span><span class="p">(</span><span class="n">all_mice_data_pairedVNS_retraining</span><span class="p">,</span> <span class="n">colour</span><span class="o">=</span><span class="s1">&#39;#0a60ffff&#39;</span><span class="p">,</span> <span class="n">save_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/d62e5f27e7e2da6fcb81f7df721e1f01b13f8ece572a8feb62e67c2502df7d36.png" src="_images/d62e5f27e7e2da6fcb81f7df721e1f01b13f8ece572a8feb62e67c2502df7d36.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trend Analysis Result (Median Slope &gt; 0): p-value=0.15039
</pre></div>
</div>
<img alt="_images/3d558ff1279e56692ef75b9dfb1ed3a67afce8be291c4b65ba634c8470be9163.png" src="_images/3d558ff1279e56692ef75b9dfb1ed3a67afce8be291c4b65ba634c8470be9163.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trend Analysis Result (Median Slope &gt; 0): p-value=0.01367
</pre></div>
</div>
<img alt="_images/f8d0adf0c9bcbd2b81e7c0f08eb6410cc63aa875d5d85c59f32d9bcf3f977e48.png" src="_images/f8d0adf0c9bcbd2b81e7c0f08eb6410cc63aa875d5d85c59f32d9bcf3f977e48.png" />
</div>
</div>
<div class="alert alert-block alert-success">
    <b>Statistical Insight: Long-Term Retrieval Dynamics</b><br>
    The analysis of the retrieval phase reveals a nuanced difference in recovery trajectories, mechanistically dissected in <b><a href="#ext_data_fig_8" style="text-decoration:underline; color:inherit;">Extended Data Fig. 8</a></b>:
    <ul>
        <li><b>Trend Analysis (Theil-Sen Slope):</b> Both groups exhibited a statistically significant positive trend in performance slopes across the 7 days (Motor Learning: <i>p=0.011</i>; Paired VNS: <i>p=0.014</i>). 
            <br>&nbsp;&nbsp;&nbsp;&nbsp;↳ <i><b>Context (<a href="#ext_data_fig_8" style="text-decoration:underline; color:inherit;">Ext. Data Fig. 8a</a>):</b> Sliding-window analysis reveals the VNS trend is driven by a specific, significant acceleration in re-acquisition during Days 2–3 (p=0.030).</i>
        </li>
        <li><b>Retraining Efficacy (Day 1 vs. Day 7):</b> However, pairwise comparison reveals the robustness of this recovery. Paired VNS mice achieved a highly significant performance gain from Day 1 to Day 7 (<i>p=0.008</i>). In contrast, Motor Learning controls failed to show a significant improvement between these endpoints (<i>p=0.77</i>).
            <br>&nbsp;&nbsp;&nbsp;&nbsp;↳ <i><b>Context (<a href="#ext_data_fig_8" style="text-decoration:underline; color:inherit;">Ext. Data Fig. 8b</a>):</b> This control "plateau" is driven by significant memory decay during the 10-week hiatus (p=0.037), whereas VNS mice maintained their skill level (p=0.448).</i>
        </li>
    </ul>
    <b>Conclusion:</b> While Motor Learning controls show a trend suggestive of slight improvement, only Paired VNS drives a robust, statistically significant re-acquisition of motor proficiency that translates into a confirmed performance gain by the end of the session (<i>Prob. Superiority = 74.1%; <a href="#ext_data_fig_8" style="text-decoration:underline; color:inherit;">see Ext. Data Fig. 8c</a></i>).
</div></section>
<section id="panel-c-oligodendrocyte-quantity-vs-recovery">
<h2>Panel c (Oligodendrocyte Quantity vs. Recovery)<a class="headerlink" href="#panel-c-oligodendrocyte-quantity-vs-recovery" title="Permalink to this heading">#</a></h2>
<p><strong>Restored oligodendrocyte number does not predict functional recovery.</strong> To determine if the absolute number of regenerated oligodendrocytes drives functional improvement, we correlated the percentage of oligodendrocyte number restoration with mean retrieval success.</p>
<p><img alt="Figure 7 Panel C" src="_images/panelC.svg" /></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>

<span class="c1"># Formatting function for consistent manuscript-style tables</span>
<span class="k">def</span> <span class="nf">pretty_print_stats</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="c1"># Hide index, apply styling</span>
    <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">to_html</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="s1">&#39;table table-striped table-hover&#39;</span><span class="p">,</span> <span class="n">justify</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)))</span>

<span class="c1"># --- PANEL C: Oligodendrocyte Number Restoration ---</span>
<span class="n">data_c</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Measure&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Mean success % (Retraining) vs. OL Number Restoration % (4wks)&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Equation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;y = 60.1951 + 0.1006x&quot;</span><span class="p">],</span>
    <span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Motor Learning (n=10), Paired VNS (n=5)&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Test&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Standard Least Squares Regression&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;F(1, 13) = 0.1750&quot;</span><span class="p">],</span>
    <span class="s2">&quot;R²&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;0.0133&quot;</span><span class="p">],</span>
    <span class="s2">&quot;P-Value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;0.6825&quot;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df_c</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_c</span><span class="p">)</span>

<span class="c1"># --- PANEL D: Sheath Number Restoration ---</span>
<span class="n">data_d</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Measure&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Mean success % (Retraining) vs. Sheath Number Restoration % (4wks)&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Equation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;y = 101.24073 - 0.1736x&quot;</span><span class="p">],</span>
    <span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Motor Learning (n=10), Paired VNS (n=5)&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Test&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Standard Least Squares Regression&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;F(1, 13) = 0.1454&quot;</span><span class="p">],</span>
    <span class="s2">&quot;R²&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;0.0111&quot;</span><span class="p">],</span>
    <span class="s2">&quot;P-Value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;0.7091&quot;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df_d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_d</span><span class="p">)</span>

<span class="c1"># --- PANEL E: Myelin Pattern Restoration ---</span>
<span class="n">data_e</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Measure&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Mean success % (Retraining) vs. Myelin Pattern Restoration % (4wks)&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Equation&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;y = 27.1377 + 0.3898x&quot;</span><span class="p">],</span>
    <span class="s2">&quot;N&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Motor Learning (n=10), Paired VNS (n=5)&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Test&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Standard Least Squares Regression&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Statistic&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;F(1, 13) = 13.3704&quot;</span><span class="p">],</span>
    <span class="s2">&quot;R²&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;0.5070&quot;</span><span class="p">],</span>
    <span class="s2">&quot;P-Value&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;0.0029 (**)&quot;</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">df_e</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_e</span><span class="p">)</span>

<span class="c1"># --- Wrapper functions for the notebook ---</span>
<span class="k">def</span> <span class="nf">show_panel_c_stats</span><span class="p">():</span>
    <span class="n">pretty_print_stats</span><span class="p">(</span><span class="n">df_c</span><span class="p">,</span> <span class="s2">&quot;--- Panel C Statistics: OL Quantity vs. Recovery ---&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">show_panel_d_stats</span><span class="p">():</span>
    <span class="n">pretty_print_stats</span><span class="p">(</span><span class="n">df_d</span><span class="p">,</span> <span class="s2">&quot;--- Panel D Statistics: Sheath Quantity vs. Recovery ---&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">show_panel_e_stats</span><span class="p">():</span>
    <span class="n">pretty_print_stats</span><span class="p">(</span><span class="n">df_e</span><span class="p">,</span> <span class="s2">&quot;--- Panel E Statistics: Pattern Fidelity vs. Recovery ---&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_panel_c_stats</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Panel C Statistics: OL Quantity vs. Recovery ---
</pre></div>
</div>
<div class="output text_html"><table border="1" class="dataframe table table-striped table-hover">
  <thead>
    <tr style="text-align: left;">
      <th>Measure</th>
      <th>Equation</th>
      <th>N</th>
      <th>Test</th>
      <th>Statistic</th>
      <th>R²</th>
      <th>P-Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Mean success % (Retraining) vs. OL Number Restoration % (4wks)</td>
      <td>y = 60.1951 + 0.1006x</td>
      <td>Motor Learning (n=10), Paired VNS (n=5)</td>
      <td>Standard Least Squares Regression</td>
      <td>F(1, 13) = 0.1750</td>
      <td>0.0133</td>
      <td>0.6825</td>
    </tr>
  </tbody>
</table></div></div>
</div>
<div class="alert alert-block alert-success">
    <b>Statistical Insight: Quantity vs. Quality</b><br>
    Analysis of cellular regeneration reveals that simple restoration of cell numbers is insufficient for functional recovery:
    <ul>
        <li><b>No Correlation (Panel C):</b> Standard least squares regression revealed no relationship between the absolute number of restored oligodendrocytes and functional recovery (<i>F(1,13)=0.175, R² = 0.0133, p = 0.6825</i>).</li>
        <li><b>Context (<a href="#ext_data_fig_7" style="text-decoration:underline; color:inherit;">Ext. Data Fig. 7a-c</a>):</b> This lack of predictive power extends to injury severity. Neither initial oligodendrocyte loss nor the percentage of surviving sheaths correlated with retrieval performance, indicating that the extent of the lesion does not dictate the limit of recovery.</li>
    </ul>
    <b>Conclusion:</b> Functional proficiency is not driven by the sheer quantity of regenerated cells or the sparing of original tissue.
</div></section>
<section id="panel-d-sheath-quantity-vs-recovery">
<h2>Panel d (Sheath Quantity vs. Recovery)<a class="headerlink" href="#panel-d-sheath-quantity-vs-recovery" title="Permalink to this heading">#</a></h2>
<p><strong>Restored sheath number does not predict functional recovery.</strong> We next assessed whether the total number of myelin sheaths regenerated (myelin load) correlated with functional outcomes.</p>
<p><img alt="Figure 7 Panel D" src="_images/panelD.svg" /></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_panel_d_stats</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Panel D Statistics: Sheath Quantity vs. Recovery ---
</pre></div>
</div>
<div class="output text_html"><table border="1" class="dataframe table table-striped table-hover">
  <thead>
    <tr style="text-align: left;">
      <th>Measure</th>
      <th>Equation</th>
      <th>N</th>
      <th>Test</th>
      <th>Statistic</th>
      <th>R²</th>
      <th>P-Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Mean success % (Retraining) vs. Sheath Number Restoration % (4wks)</td>
      <td>y = 101.24073 - 0.1736x</td>
      <td>Motor Learning (n=10), Paired VNS (n=5)</td>
      <td>Standard Least Squares Regression</td>
      <td>F(1, 13) = 0.1454</td>
      <td>0.0111</td>
      <td>0.7091</td>
    </tr>
  </tbody>
</table></div></div>
</div>
<div class="alert alert-block alert-success">
    <b>Statistical Insight: Myelin Load is Insufficient</b><br>
    Similar to cell number, the total quantity of myelin sheaths does not determine functional success:
    <ul>
        <li><b>No Correlation (Panel D):</b> The percentage of sheath number restoration showed no significant correlation with behavioral proficiency (<i>F(1,13)=0.145, R² = 0.0111, p = 0.7091</i>).</li>
        <li><b>Context:</b> The regression equation (<i>y = 101.24 - 0.17x</i>) suggests a flat or slightly negative slope, reinforcing that "more myelin" is not necessarily "better myelin" for complex motor skill retrieval.</li>
    </ul>
</div></section>
<section id="panel-e-pattern-fidelity-drives-recovery">
<h2>Panel e (Pattern Fidelity Drives Recovery)<a class="headerlink" href="#panel-e-pattern-fidelity-drives-recovery" title="Permalink to this heading">#</a></h2>
<p><strong>Myelin pattern restoration predicts functional proficiency.</strong> We tested the hypothesis that the <em>precision</em> of remyelination—restoring the original, pre-lesion distribution of myelin sheaths along axons—is the key determinant of recovery.</p>
<p><img alt="Figure 7 Panel E" src="_images/panelE.svg" /></p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_panel_e_stats</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Panel E Statistics: Pattern Fidelity vs. Recovery ---
</pre></div>
</div>
<div class="output text_html"><table border="1" class="dataframe table table-striped table-hover">
  <thead>
    <tr style="text-align: left;">
      <th>Measure</th>
      <th>Equation</th>
      <th>N</th>
      <th>Test</th>
      <th>Statistic</th>
      <th>R²</th>
      <th>P-Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Mean success % (Retraining) vs. Myelin Pattern Restoration % (4wks)</td>
      <td>y = 27.1377 + 0.3898x</td>
      <td>Motor Learning (n=10), Paired VNS (n=5)</td>
      <td>Standard Least Squares Regression</td>
      <td>F(1, 13) = 13.3704</td>
      <td>0.5070</td>
      <td>0.0029 (**)</td>
    </tr>
  </tbody>
</table></div></div>
</div>
<div class="alert alert-block alert-success">
    <b>Statistical Insight: The Primacy of Pattern</b><br>
    In contrast to cell or sheath quantity, the <i>fidelity</i> of the restored myelin pattern is the primary driver of functional recovery:
    <ul>
        <li><b>Significant Correlation (Panel E):</b> Standard least squares regression demonstrated a highly significant positive correlation between myelin pattern restoration and behavioral proficiency (<i>F(1,13)=13.37, R² = 0.5070, p = 0.0029</i>).</li>
        <li><b>VNS Specificity (<a href="#ext_data_fig_7" style="text-decoration:underline; color:inherit;">Ext. Data Fig. 7f</a>):</b> Intriguingly, when split by group, this correlation was driven specifically by the Paired VNS group (<i>R² = 0.812, p = 0.0369</i>), whereas Motor Learning controls showed no such relationship (<i>R² = 0.237, p = 0.1532</i>).</li>
        <li><b>Independence (<a href="#ext_data_fig_7" style="text-decoration:underline; color:inherit;">Ext. Data Fig. 7d–e</a>):</b> This pattern restoration was distinct from oligodendrocyte loss dynamics, confirming that it represents a specific reconstructive process rather than a simple reflection of injury severity.</li>
    </ul>
    <b>Conclusion:</b> Long-term accuracy is determined by the fidelity of the restored myelin pattern (<i>y = 27.14 + 0.39x</i>), suggesting that Paired VNS actively promotes the precise reconstruction of behaviorally relevant circuits.
</div></section>
<section id="panel-f-myrf-experimental-timeline">
<h2>Panel f (Myrf Experimental Timeline)<a class="headerlink" href="#panel-f-myrf-experimental-timeline" title="Permalink to this heading">#</a></h2>
<p><img alt="Figure 7 Panel F" src="_images/panelF.svg" />
Experimental timeline with retrieval intervention 10 weeks after the end of the initial learning period but for Myrf mice with tomoxifen controlled oligodendrogenesis.</p>
</section>
<section id="panel-g-oligodendrogenesis-is-required-for-paired-vns-efficacy">
<h2>Panel g: Oligodendrogenesis is Required for Paired-VNS Efficacy<a class="headerlink" href="#panel-g-oligodendrogenesis-is-required-for-paired-vns-efficacy" title="Permalink to this heading">#</a></h2>
<p><strong>VNS-driven functional recovery depends on adaptive myelination.</strong> To determine if the long-term benefit of VNS requires the generation of new myelin, we repeated the paradigm in <em>Myrf</em> conditional knockout (cKO) mice, which cannot form new oligodendrocytes.</p>
<ul class="simple">
<li><p><strong>Myrf WT (Control):</strong> VNS-treated controls exhibited the expected significant functional recovery during the retrieval phase.</p></li>
<li><p><strong>Myrf cKO (Experimental):</strong> In the absence of adaptive myelination, VNS failed to drive significant motor recovery, with animals remaining at their post-lesion baseline.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load up all myrf data</span>
<span class="n">mobp161_learning_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3818181818</span><span class="p">,</span>
<span class="mf">0.59375</span><span class="p">,</span>
<span class="mf">0.2602739726</span><span class="p">,</span>
<span class="mf">0.1686746988</span><span class="p">,</span>
<span class="mf">0.3956043956</span><span class="p">,</span>
<span class="mf">0.53</span><span class="p">,</span>
<span class="mf">0.2714285714</span><span class="p">]</span>
<span class="n">mobp163_learning_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1587301587</span><span class="p">,</span>
<span class="mf">0.5409836066</span><span class="p">,</span>
<span class="mf">0.2678571429</span><span class="p">,</span>
<span class="mf">0.2777777778</span><span class="p">,</span>
<span class="mf">0.4186046512</span><span class="p">,</span>
<span class="mf">0.4505494505</span><span class="p">,</span>
<span class="mf">0.4368932039</span><span class="p">]</span>
<span class="n">mobp164_learning_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.12</span><span class="p">,</span>
<span class="mf">0.2</span><span class="p">,</span>
<span class="mf">0.15</span><span class="p">,</span>
<span class="mf">0.1343283582</span><span class="p">,</span>
<span class="mf">0.1756756757</span><span class="p">,</span>
<span class="mf">0.2209302326</span><span class="p">,</span>
<span class="mf">0.25</span><span class="p">]</span>
<span class="n">mobp182_learning_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span>
<span class="mf">0.34375</span><span class="p">,</span>
<span class="mf">0.5</span><span class="p">,</span>
<span class="mf">0.45</span><span class="p">,</span>
<span class="mf">0.2584269663</span><span class="p">,</span>
<span class="mf">0.303030303</span><span class="p">,</span>
<span class="mf">0.4166666667</span><span class="p">]</span>
<span class="n">mobp183_learning_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span>
<span class="mf">0.2857142857</span><span class="p">,</span>
<span class="mf">0.3055555556</span><span class="p">,</span>
<span class="mf">0.2</span><span class="p">,</span>
<span class="mf">0.2580645161</span><span class="p">,</span>
<span class="mf">0.2745098039</span><span class="p">,</span>
<span class="mf">0.3787878788</span><span class="p">]</span>
<span class="n">mobp184_learning_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3333333333</span><span class="p">,</span>
<span class="mf">0.3018867925</span><span class="p">,</span>
<span class="mf">0.1129032258</span><span class="p">,</span>
<span class="mf">0.09333333333</span><span class="p">,</span>
<span class="mf">0.2093023256</span><span class="p">,</span>
<span class="mf">0.4864864865</span><span class="p">,</span>
<span class="mf">0.4680851064</span><span class="p">]</span>
<span class="n">mobp188_learning_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.08450704225</span><span class="p">,</span>
<span class="mf">0.2112676056</span><span class="p">,</span>
<span class="mf">0.3150684932</span><span class="p">,</span>
<span class="mf">0.2535211268</span><span class="p">,</span>
<span class="mf">0.5777777778</span><span class="p">,</span>
<span class="mf">0.3625</span><span class="p">,</span>
<span class="mf">0.3679245283</span><span class="p">]</span>
<span class="n">mobp189_learning_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1923076923</span><span class="p">,</span>
<span class="mf">0.3548387097</span><span class="p">,</span>
<span class="mf">0.2857142857</span><span class="p">,</span>
<span class="mf">0.3125</span><span class="p">,</span>
<span class="mf">0.25</span><span class="p">,</span>
<span class="mf">0.4415584416</span><span class="p">,</span>
<span class="mf">0.52</span><span class="p">]</span>
<span class="n">mobp192_learning_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1206896552</span><span class="p">,</span>
<span class="mf">0.05882352941</span><span class="p">,</span>
<span class="mf">0.26</span><span class="p">,</span>
<span class="mf">0.1123595506</span><span class="p">,</span>
<span class="mf">0.3815789474</span><span class="p">,</span>
<span class="mf">0.2142857143</span><span class="p">,</span>
<span class="mf">0.191011236</span><span class="p">]</span>

<span class="n">creNegative_learning</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp161_learning_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp163_learning_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp164_learning_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp182_learning_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp183_learning_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp184_learning_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp188_learning_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp189_learning_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp192_learning_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">]</span>

<span class="n">mobp161_retraining_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3289473684</span><span class="p">,</span>
<span class="mf">0.3272727273</span><span class="p">,</span>
<span class="mf">0.3333333333</span><span class="p">,</span>
<span class="mf">0.2432432432</span><span class="p">,</span>
<span class="mf">0.2093023256</span><span class="p">,</span>
<span class="mf">0.375</span><span class="p">,</span>
<span class="mf">0.358490566</span><span class="p">]</span>
<span class="n">mobp163_retraining_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.09803921569</span><span class="p">,</span>
<span class="mf">0.4</span><span class="p">,</span>
<span class="mf">0.3571428571</span><span class="p">,</span>
<span class="mf">0.3924050633</span><span class="p">,</span>
<span class="mf">0.5555555556</span><span class="p">,</span>
<span class="mf">0.6145833333</span><span class="p">,</span>
<span class="mf">0.7047619048</span><span class="p">,]</span>
<span class="n">mobp164_retraining_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1184210526</span><span class="p">,</span>
<span class="mf">0.2</span><span class="p">,</span>
<span class="mf">0.2133333333</span><span class="p">,</span>
<span class="mf">0.1927710843</span><span class="p">,</span>
<span class="mf">0.1585365854</span><span class="p">,</span>
<span class="mf">0.1764705882</span><span class="p">,</span>
<span class="mf">0.1428571429</span><span class="p">]</span>
<span class="n">mobp182_retraining_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3829787234</span><span class="p">,</span>
<span class="mf">0.4</span><span class="p">,</span>
<span class="mf">0.3555555556</span><span class="p">,</span>
<span class="mf">0.3166666667</span><span class="p">,</span>
<span class="mf">0.2452830189</span><span class="p">,</span>
<span class="mf">0.4</span><span class="p">,</span>
<span class="mf">0.303030303</span><span class="p">]</span>
<span class="n">mobp183_retraining_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01724137931</span><span class="p">,</span>
<span class="mf">0.1044776119</span><span class="p">,</span>
<span class="mf">0.1265822785</span><span class="p">,</span>
<span class="mf">0.1098901099</span><span class="p">,</span>
<span class="mf">0.1188118812</span><span class="p">,</span>
<span class="mf">0.1727272727</span><span class="p">,</span>
<span class="mf">0.1401869159</span><span class="p">]</span>
<span class="n">mobp184_retraining_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span>
<span class="mf">0.3137254902</span><span class="p">,</span>
<span class="mf">0.4788732394</span><span class="p">,</span>
<span class="mf">0.3164556962</span><span class="p">,</span>
<span class="mf">0.202247191</span><span class="p">,</span>
<span class="mf">0.2857142857</span><span class="p">,</span>
<span class="mf">0.3301886792</span><span class="p">]</span>
<span class="n">mobp188_retraining_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2112676056</span><span class="p">,</span>
<span class="mf">0.4027777778</span><span class="p">,</span>
<span class="mf">0.4246575342</span><span class="p">,</span>
<span class="mf">0.2112676056</span><span class="p">,</span>
<span class="mf">0.2666666667</span><span class="p">,</span>
<span class="mf">0.2105263158</span><span class="p">,</span>
<span class="mf">0.3466666667</span><span class="p">]</span>
<span class="n">mobp189_retraining_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3818181818</span><span class="p">,</span>
<span class="mf">0.5846153846</span><span class="p">,</span>
<span class="mf">0.4285714286</span><span class="p">,</span>
<span class="mf">0.3333333333</span><span class="p">,</span>
<span class="mf">0.34375</span><span class="p">,</span>
<span class="mf">0.5566037736</span><span class="p">,</span>
<span class="mf">0.5</span><span class="p">]</span>
<span class="n">mobp192_retraining_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span>
<span class="mf">0.3278688525</span><span class="p">,</span>
<span class="mf">0.35</span><span class="p">,</span>
<span class="mf">0.3614457831</span><span class="p">,</span>
<span class="mf">0.5326086957</span><span class="p">,</span>
<span class="mf">0.2871287129</span><span class="p">,</span>
<span class="mf">0.3009708738</span><span class="p">]</span>

<span class="n">creNegative_retraining</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp161_retraining_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp163_retraining_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp164_retraining_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp182_retraining_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp183_retraining_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp184_retraining_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp188_retraining_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp189_retraining_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp192_retraining_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">]</span>

<span class="n">creNegative_animal_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;mobp161&#39;</span><span class="p">,</span> <span class="s1">&#39;mobp163&#39;</span><span class="p">,</span> <span class="s1">&#39;mobp164&#39;</span><span class="p">,</span> <span class="s1">&#39;mobp182&#39;</span><span class="p">,</span> <span class="s1">&#39;mobp183&#39;</span><span class="p">,</span>
    <span class="s1">&#39;mobp184&#39;</span><span class="p">,</span> <span class="s1">&#39;mobp188&#39;</span><span class="p">,</span> <span class="s1">&#39;mobp189&#39;</span><span class="p">,</span> <span class="s1">&#39;mobp192&#39;</span>
<span class="p">]</span>
<span class="n">creNegative_vns_check_failed</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mobp161&#39;</span><span class="p">,</span><span class="s1">&#39;mobp164&#39;</span><span class="p">]</span>

<span class="n">mobp165_learning_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1454545455</span><span class="p">,</span>
<span class="mf">0.3</span><span class="p">,</span>
<span class="mf">0.203125</span><span class="p">,</span>
<span class="mf">0.1764705882</span><span class="p">,</span>
<span class="mf">0.25</span><span class="p">,</span>
<span class="mf">0.3466666667</span><span class="p">,</span>
<span class="mf">0.3974358974</span><span class="p">]</span>
<span class="n">mobp166_learning_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1168831169</span><span class="p">,</span>
<span class="mf">0.3043478261</span><span class="p">,</span>
<span class="mf">0.2666666667</span><span class="p">,</span>
<span class="mf">0.1929824561</span><span class="p">,</span>
<span class="mf">0.4426229508</span><span class="p">,</span>
<span class="mf">0.397260274</span><span class="p">,</span>
<span class="mf">0.3975903614</span><span class="p">]</span>
<span class="n">mobp167_learning_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.07594936709</span><span class="p">,</span>
<span class="mf">0.3137254902</span><span class="p">,</span>
<span class="mf">0.4107142857</span><span class="p">,</span>
<span class="mf">0.55</span><span class="p">,</span>
<span class="mf">0.5076923077</span><span class="p">,</span>
<span class="mf">0.3970588235</span><span class="p">,</span>
<span class="mf">0.3372093023</span><span class="p">]</span>
<span class="n">mobp168_learning_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2291666667</span><span class="p">,</span>
<span class="mf">0.2282608696</span><span class="p">,</span>
<span class="mf">0.1818181818</span><span class="p">,</span>
<span class="mf">0.2098765432</span><span class="p">,</span>
<span class="mf">0.3333333333</span><span class="p">,</span>
<span class="mf">0.2872340426</span><span class="p">,</span>
<span class="mf">0.3636363636</span><span class="p">]</span>
<span class="n">mobp185_learning_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.125</span><span class="p">,</span>
<span class="mf">0.0487804878</span><span class="p">,</span>
<span class="mf">0.25</span><span class="p">,</span>
<span class="mf">0.2</span><span class="p">,</span>
<span class="mf">0.1627906977</span><span class="p">,</span>
<span class="mf">0.1931818182</span><span class="p">,</span>
<span class="mf">0.406779661</span><span class="p">]</span>
<span class="n">mobp187_learning_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3043478261</span><span class="p">,</span>
<span class="mf">0.2727272727</span><span class="p">,</span>
<span class="mf">0.375</span><span class="p">,</span>
<span class="mf">0.4166666667</span><span class="p">,</span>
<span class="mf">0.2876712329</span><span class="p">,</span>
<span class="mf">0.3333333333</span><span class="p">,</span>
<span class="mf">0.3492063492</span><span class="p">]</span>
<span class="n">mobp190_learning_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2222222222</span><span class="p">,</span>
<span class="mf">0.3052631579</span><span class="p">,</span>
<span class="mf">0.4020618557</span><span class="p">,</span>
<span class="mf">0.4210526316</span><span class="p">,</span>
<span class="mf">0.2871287129</span><span class="p">,</span>
<span class="mf">0.3398058252</span><span class="p">,</span>
<span class="mf">0.4270833333</span><span class="p">]</span>

<span class="n">crePositive_learning</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp165_learning_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp166_learning_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp167_learning_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp168_learning_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp185_learning_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp187_learning_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp190_learning_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">]</span>

<span class="n">mobp165_retraining_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2027027027</span><span class="p">,</span>
<span class="mf">0.1794871795</span><span class="p">,</span>
<span class="mf">0.2643678161</span><span class="p">,</span>
<span class="mf">0.3456790123</span><span class="p">,</span>
<span class="mf">0.402173913</span><span class="p">,</span>
<span class="mf">0.2643678161</span><span class="p">,</span>
<span class="mf">0.3</span><span class="p">]</span>
<span class="n">mobp166_retraining_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3137254902</span><span class="p">,</span>
<span class="mf">0.3</span><span class="p">,</span>
<span class="mf">0.3015873016</span><span class="p">,</span>
<span class="mf">0.4179104478</span><span class="p">,</span>
<span class="mf">0.4310344828</span><span class="p">,</span>
<span class="mf">0.3975903614</span><span class="p">,</span>
<span class="mf">0.3513513514</span><span class="p">]</span>
<span class="n">mobp167_retraining_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3444444444</span><span class="p">,</span>
<span class="mf">0.2127659574</span><span class="p">,</span>
<span class="mf">0.1919191919</span><span class="p">,</span>
<span class="mf">0.3265306122</span><span class="p">,</span>
<span class="mf">0.2549019608</span><span class="p">,</span>
<span class="mf">0.2980769231</span><span class="p">,</span>
<span class="mf">0.308411215</span><span class="p">]</span>
<span class="n">mobp168_retraining_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.375</span><span class="p">,</span>
<span class="mf">0.2156862745</span><span class="p">,</span>
<span class="mf">0.2777777778</span><span class="p">,</span>
<span class="mf">0.3571428571</span><span class="p">,</span>
<span class="mf">0.3157894737</span><span class="p">,</span>
<span class="mf">0.3103448276</span><span class="p">,</span>
<span class="mf">0.3278688525</span><span class="p">]</span>
<span class="n">mobp185_retraining_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1204819277</span><span class="p">,</span>
<span class="mf">0.08536585366</span><span class="p">,</span>
<span class="mf">0.25</span><span class="p">,</span>
<span class="mf">0.1882352941</span><span class="p">,</span>
<span class="mf">0.1511627907</span><span class="p">,</span>
<span class="mf">0.1931818182</span><span class="p">,</span>
<span class="mf">0.2222222222</span><span class="p">]</span>
<span class="n">mobp187_retraining_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3647058824</span><span class="p">,</span>
<span class="mf">0.2352941176</span><span class="p">,</span>
<span class="mf">0.1428571429</span><span class="p">,</span>
<span class="mf">0.3225806452</span><span class="p">,</span>
<span class="mf">0.2395833333</span><span class="p">,</span>
<span class="mf">0.2857142857</span><span class="p">,</span>
<span class="mf">0.3069306931</span><span class="p">]</span>
<span class="n">mobp190_retraining_successrates</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.3076923077</span><span class="p">,</span>
<span class="mf">0.3263157895</span><span class="p">,</span>
<span class="mf">0.2</span><span class="p">,</span>
<span class="mf">0.3090909091</span><span class="p">,</span>
<span class="mf">0.4536082474</span><span class="p">,</span>
<span class="mf">0.3203883495</span><span class="p">,</span>
<span class="mf">0.3867924528</span><span class="p">]</span>
<span class="n">crePositive_animal_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mobp165&#39;</span><span class="p">,</span><span class="s1">&#39;mobp166&#39;</span><span class="p">,</span><span class="s1">&#39;mobp167&#39;</span><span class="p">,</span><span class="s1">&#39;mobp168&#39;</span><span class="p">,</span><span class="s1">&#39;mobp185&#39;</span><span class="p">,</span><span class="s1">&#39;mobp187&#39;</span><span class="p">,</span><span class="s1">&#39;mobp190&#39;</span><span class="p">]</span>
<span class="n">crePositive_vns_check_failed</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mobp165&#39;</span><span class="p">,</span><span class="s1">&#39;mobp166&#39;</span><span class="p">,</span><span class="s1">&#39;mobp167&#39;</span><span class="p">]</span>

<span class="n">crePositive_retraining</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp165_retraining_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp166_retraining_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp167_retraining_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp168_retraining_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp185_retraining_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp187_retraining_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span>
<span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mobp190_retraining_successrates</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">]</span>

<span class="c1"># Create dictionaries zip-mapped by name</span>
<span class="n">all_mice_data_creNegative_learning</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">creNegative_animal_names</span><span class="p">,</span> <span class="n">creNegative_learning</span><span class="p">))</span>
<span class="n">all_mice_data_creNegative_retraining</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">creNegative_animal_names</span><span class="p">,</span> <span class="n">creNegative_retraining</span><span class="p">))</span>

<span class="n">all_mice_data_crePositive_learning</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">crePositive_animal_names</span><span class="p">,</span> <span class="n">crePositive_learning</span><span class="p">))</span>
<span class="n">all_mice_data_crePositive_retraining</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">crePositive_animal_names</span><span class="p">,</span> <span class="n">crePositive_retraining</span><span class="p">))</span>

<span class="c1"># Filter names lists (Exclude check failed)</span>
<span class="n">creNegative_names_clean</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">creNegative_animal_names</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">creNegative_vns_check_failed</span><span class="p">]</span>
<span class="n">crePositive_names_clean</span> <span class="o">=</span> <span class="p">[</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">crePositive_animal_names</span> <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">crePositive_vns_check_failed</span><span class="p">]</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">creNeg_learning_clean</span> <span class="o">=</span> <span class="p">[</span><span class="n">all_mice_data_creNegative_learning</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">creNegative_names_clean</span><span class="p">]</span>
<span class="n">creNeg_retraining_clean</span> <span class="o">=</span> <span class="p">[</span><span class="n">all_mice_data_creNegative_retraining</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">creNegative_names_clean</span><span class="p">]</span>

<span class="n">crePos_learning_clean</span> <span class="o">=</span> <span class="p">[</span><span class="n">all_mice_data_crePositive_learning</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">crePositive_names_clean</span><span class="p">]</span>
<span class="n">crePos_retraining_clean</span> <span class="o">=</span> <span class="p">[</span><span class="n">all_mice_data_crePositive_retraining</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">crePositive_names_clean</span><span class="p">]</span>

<span class="c1"># --- A. Myrf WT (Cre Negative) ---</span>
<span class="c1"># Color: #d8a6a6ff (Light Red)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Myrf WT (Cre-): VNS Control ---&quot;</span><span class="p">)</span>
<span class="n">plot_learning_stats</span><span class="p">(</span><span class="n">creNeg_learning_clean</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Training days&quot;</span><span class="p">,</span> <span class="s2">&quot;Success rate (%)&quot;</span><span class="p">,</span> <span class="n">colormapping</span><span class="o">=</span><span class="s2">&quot;#d8a6a6ff&quot;</span><span class="p">)</span>
<span class="n">plot_learning_stats</span><span class="p">(</span><span class="n">creNeg_retraining_clean</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Retraining (days)&quot;</span><span class="p">,</span> <span class="s2">&quot;Success rate (%)&quot;</span><span class="p">,</span> <span class="n">colormapping</span><span class="o">=</span><span class="s2">&quot;#d8a6a6ff&quot;</span><span class="p">)</span>
<span class="n">plot_retraining_comparison</span><span class="p">(</span><span class="n">all_mice_data_creNegative_retraining</span><span class="p">,</span> <span class="n">colour</span><span class="o">=</span><span class="s1">&#39;#d8a6a6ff&#39;</span><span class="p">,</span> 
                           <span class="n">animal_names</span><span class="o">=</span><span class="n">creNegative_names_clean</span><span class="p">,</span> <span class="n">save_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># --- B. Myrf cKO (Cre Positive) ---</span>
<span class="c1"># Color: #a00000ff (Dark Red)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Myrf cKO (Cre+): Myelin Deficient ---&quot;</span><span class="p">)</span>
<span class="n">plot_learning_stats</span><span class="p">(</span><span class="n">crePos_learning_clean</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Training days&quot;</span><span class="p">,</span> <span class="s2">&quot;Success rate (%)&quot;</span><span class="p">,</span> <span class="n">colormapping</span><span class="o">=</span><span class="s2">&quot;#a00000ff&quot;</span><span class="p">)</span>
<span class="n">plot_learning_stats</span><span class="p">(</span><span class="n">crePos_retraining_clean</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Retraining (days)&quot;</span><span class="p">,</span> <span class="s2">&quot;Success rate (%)&quot;</span><span class="p">,</span> <span class="n">colormapping</span><span class="o">=</span><span class="s2">&quot;#a00000ff&quot;</span><span class="p">)</span>
<span class="n">plot_retraining_comparison</span><span class="p">(</span><span class="n">all_mice_data_crePositive_retraining</span><span class="p">,</span> <span class="n">colour</span><span class="o">=</span><span class="s1">&#39;#a00000ff&#39;</span><span class="p">,</span> 
                           <span class="n">animal_names</span><span class="o">=</span><span class="n">crePositive_names_clean</span><span class="p">,</span> <span class="n">save_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Myrf WT (Cre-): VNS Control ---
</pre></div>
</div>
<img alt="_images/2fd72d6dbe6f108f3b456bb7d8d999074ad7d5ecca5a900ca9c9e447b43cfc60.png" src="_images/2fd72d6dbe6f108f3b456bb7d8d999074ad7d5ecca5a900ca9c9e447b43cfc60.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trend Analysis Result (Median Slope &gt; 0): p-value=0.00781
</pre></div>
</div>
<img alt="_images/b5887da079bcce51a16095ec0ae93dda0348fad2558050938a8b5a27c8106d36.png" src="_images/b5887da079bcce51a16095ec0ae93dda0348fad2558050938a8b5a27c8106d36.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trend Analysis Result (Median Slope &gt; 0): p-value=0.07812
</pre></div>
</div>
<img alt="_images/a9057293a9bdc328abc9295b8d9e2df7cb3174db7a052cca235ff25cee652f22.png" src="_images/a9057293a9bdc328abc9295b8d9e2df7cb3174db7a052cca235ff25cee652f22.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Myrf cKO (Cre+): Myelin Deficient ---
</pre></div>
</div>
<img alt="_images/d702bce9825fa32f569992a0414e2e00cd284f2eba3f0fe56771e1421b6bfe3f.png" src="_images/d702bce9825fa32f569992a0414e2e00cd284f2eba3f0fe56771e1421b6bfe3f.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trend Analysis Result (Median Slope &gt; 0): p-value=0.06250
</pre></div>
</div>
<img alt="_images/28d54988b5be48ede4a7e08468d30020700de69d8171ab21a382e3e2e461f6bc.png" src="_images/28d54988b5be48ede4a7e08468d30020700de69d8171ab21a382e3e2e461f6bc.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trend Analysis Result (Median Slope &gt; 0): p-value=0.06250
</pre></div>
</div>
<img alt="_images/5a7190e0afb57498f6afaea43f928df5a71f999676f60ff502517470a213c01d.png" src="_images/5a7190e0afb57498f6afaea43f928df5a71f999676f60ff502517470a213c01d.png" />
</div>
</div>
<div class="alert alert-block alert-success">
    <b>Statistical Insight: Myelin-Dependence of Recovery</b><br>
    Comparing the retrieval trajectories reveals that adaptive myelination is a necessary mechanism for VNS-induced functional plasticity, a finding confirmed by detailed stability analysis (<i>see <a href="#ext_data_fig_8d_f" style="text-decoration:underline; color:inherit;">Ext. Data Fig. 8d–f</a></i>) and robust to inclusion criteria (<i>see <a href="#ext_data_fig_7g" style="text-decoration:underline; color:inherit;">Ext. Data Fig. 7g</a></i>):
    <ul>
        <li><b>Myrf WT (Intact Myelination):</b> VNS successfully drove functional recovery. While the overall trend across 7 days approached significance (<i>p = 0.078</i>), pairwise comparison confirmed a statistically significant improvement from Day 1 to Day 7 of retrieval (<b>p = 0.031</b>).
            <br>&nbsp;&nbsp;&nbsp;&nbsp;↳ <i><b>Consolidation (<a href="#ext_data_fig_8d_f" style="text-decoration:underline; color:inherit;">Ext. Data Fig. 8e</a>):</b> Animals showed near-perfect retention over the 10-week hiatus (p=0.469), with 78.5% of mice maintaining stable performance.</i>
            <br>&nbsp;&nbsp;&nbsp;&nbsp;↳ <i><b>Robustness (<a href="#ext_data_fig_7g" style="text-decoration:underline; color:inherit;">Ext. Data Fig. 7g</a>):</b> The active improvement during retrieval is preserved when analyzing all animals (Paired D1 vs D7: p=0.020).</i>
        </li>
        <li><b>Myrf cKO (Blocked Myelination):</b> In mice lacking the ability to form new myelin, VNS failed to drive recovery. These animals showed no significant upward trend (<i>p = 0.063</i>) and, crucially, failed to achieve any performance gain between the start and end of the session (<b>p = 0.625</b>).
            <br>&nbsp;&nbsp;&nbsp;&nbsp;↳ <i><b>Deterioration (<a href="#ext_data_fig_8d_f" style="text-decoration:underline; color:inherit;">Ext. Data Fig. 8e</a>):</b> Unlike controls, cKO mice exhibited significant skill decay during the hiatus (p=0.017) and profound instability (p=0.0005 vs WT).</i>
            <br>&nbsp;&nbsp;&nbsp;&nbsp;↳ <i><b>Robustness (<a href="#ext_data_fig_7g" style="text-decoration:underline; color:inherit;">Ext. Data Fig. 7g</a>):</b> Even when including all animals, cKO mice failed to show significant pairwise improvement (p=0.375), validating that the blockade of recovery is absolute.</i>
        </li>
    </ul>
    <b>Conclusion:</b> The therapeutic effect of VNS is strictly myelin-dependent. Without oligodendrogenesis, the "structural bridge" required for consolidation is lost, resulting in profound skill deterioration and a failure to recover.
</div></section>
<section id="extended-data-figures">
<h2>Extended Data Figures<a class="headerlink" href="#extended-data-figures" title="Permalink to this heading">#</a></h2>
<p><a id="ext_data_fig_7"></a></p>
<section id="extended-data-figure-7">
<h3>Extended Data Figure 7<a class="headerlink" href="#extended-data-figure-7" title="Permalink to this heading">#</a></h3>
<p><strong>Injury severity and quantity do not predict outcome.</strong> Detailed correlation analysis of cellular metrics against functional recovery.</p>
<section id="a-f">
<h4>a —- f<a class="headerlink" href="#a-f" title="Permalink to this heading">#</a></h4>
<p><img alt="Figure 7 Panel E" src="_images/extendedDataFig7a-f.svg" /></p>
<p><a id="ext_data_fig_7g"></a></p>
</section>
<section id="g">
<h4>g<a class="headerlink" href="#g" title="Permalink to this heading">#</a></h4>
<p><strong>Validation in the full cohort.</strong> To ensure that the loss of recovery in <em>Myrf</em> cKO mice was not driven by exclusion criteria, we analyzed the full cohort of animals (All Animals).</p>
<ul class="simple">
<li><p><strong>Myrf WT (All):</strong> Retained a statistically significant functional recovery (Day 1 vs Day 7: <strong>p=0.020</strong>), replicating the main finding.</p></li>
<li><p><strong>Myrf cKO (All):</strong> Consistently failed to show significant functional gains (Day 1 vs Day 7: <strong>p=0.375</strong>), confirming that the lack of adaptive myelination prevents VNS-driven recovery.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==========================================</span>
<span class="c1"># EXTENDED DATA FIGURE 7G: All Animals (No Filtering)</span>
<span class="c1"># ==========================================</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== EXTENDED DATA FIG 7G: All Animals (No VNS Check Filtering) ===&quot;</span><span class="p">)</span>

<span class="c1"># --- A. Myrf WT (Cre Negative) - All Animals ---</span>
<span class="c1"># Using the full &#39;all_mice_data_creNegative_learning&#39; dictionary</span>
<span class="c1"># We extract all values regardless of &#39;vns_check_failed&#39; status</span>
<span class="n">creNeg_learning_ALL</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_mice_data_creNegative_learning</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">creNeg_retraining_ALL</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_mice_data_creNegative_retraining</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">creNeg_names_ALL</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_mice_data_creNegative_learning</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Myrf WT (All Animals) ---&quot;</span><span class="p">)</span>
<span class="n">plot_learning_stats</span><span class="p">(</span><span class="n">creNeg_learning_ALL</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Training days&quot;</span><span class="p">,</span> <span class="s2">&quot;Success rate (%)&quot;</span><span class="p">,</span> <span class="n">colormapping</span><span class="o">=</span><span class="s2">&quot;#d8a6a6ff&quot;</span><span class="p">)</span>
<span class="n">plot_learning_stats</span><span class="p">(</span><span class="n">creNeg_retraining_ALL</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Retraining (days)&quot;</span><span class="p">,</span> <span class="s2">&quot;Success rate (%)&quot;</span><span class="p">,</span> <span class="n">colormapping</span><span class="o">=</span><span class="s2">&quot;#d8a6a6ff&quot;</span><span class="p">)</span>
<span class="n">plot_retraining_comparison</span><span class="p">(</span><span class="n">all_mice_data_creNegative_retraining</span><span class="p">,</span> <span class="n">colour</span><span class="o">=</span><span class="s1">&#39;#d8a6a6ff&#39;</span><span class="p">,</span> 
                           <span class="n">animal_names</span><span class="o">=</span><span class="n">creNeg_names_ALL</span><span class="p">,</span> <span class="n">save_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

<span class="c1"># --- B. Myrf cKO (Cre Positive) - All Animals ---</span>
<span class="c1"># Using the full &#39;all_mice_data_crePositive_learning&#39; dictionary</span>
<span class="n">crePos_learning_ALL</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_mice_data_crePositive_learning</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">crePos_retraining_ALL</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_mice_data_crePositive_retraining</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">crePos_names_ALL</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">all_mice_data_crePositive_learning</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">--- Myrf cKO (All Animals) ---&quot;</span><span class="p">)</span>
<span class="n">plot_learning_stats</span><span class="p">(</span><span class="n">crePos_learning_ALL</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Training days&quot;</span><span class="p">,</span> <span class="s2">&quot;Success rate (%)&quot;</span><span class="p">,</span> <span class="n">colormapping</span><span class="o">=</span><span class="s2">&quot;#a00000ff&quot;</span><span class="p">)</span>
<span class="n">plot_learning_stats</span><span class="p">(</span><span class="n">crePos_retraining_ALL</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Retraining (days)&quot;</span><span class="p">,</span> <span class="s2">&quot;Success rate (%)&quot;</span><span class="p">,</span> <span class="n">colormapping</span><span class="o">=</span><span class="s2">&quot;#a00000ff&quot;</span><span class="p">)</span>
<span class="n">plot_retraining_comparison</span><span class="p">(</span><span class="n">all_mice_data_crePositive_retraining</span><span class="p">,</span> <span class="n">colour</span><span class="o">=</span><span class="s1">&#39;#a00000ff&#39;</span><span class="p">,</span> 
                           <span class="n">animal_names</span><span class="o">=</span><span class="n">crePos_names_ALL</span><span class="p">,</span> <span class="n">save_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>=== EXTENDED DATA FIG 7G: All Animals (No VNS Check Filtering) ===

--- Myrf WT (All Animals) ---
</pre></div>
</div>
<img alt="_images/552022eb2a83e7d34e564ca549d79ac943f1eef03b83c92dc0d74d151f6dafad.png" src="_images/552022eb2a83e7d34e564ca549d79ac943f1eef03b83c92dc0d74d151f6dafad.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trend Analysis Result (Median Slope &gt; 0): p-value=0.00586
</pre></div>
</div>
<img alt="_images/5cac6d0f174448ab6c408a614f62fdf54f8a1d52f64461964918aae31cf2be59.png" src="_images/5cac6d0f174448ab6c408a614f62fdf54f8a1d52f64461964918aae31cf2be59.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trend Analysis Result (Median Slope &gt; 0): p-value=0.10156
</pre></div>
</div>
<img alt="_images/c7814c9b535698cbaeb530b07f47661e0084d2b15519c20a2d3737ba3e3c8ba3.png" src="_images/c7814c9b535698cbaeb530b07f47661e0084d2b15519c20a2d3737ba3e3c8ba3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Myrf cKO (All Animals) ---
</pre></div>
</div>
<img alt="_images/d550c60b7f81d552f9329e87f64e5fd1c30fb59b7bc66dd66516b5f905e91125.png" src="_images/d550c60b7f81d552f9329e87f64e5fd1c30fb59b7bc66dd66516b5f905e91125.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trend Analysis Result (Median Slope &gt; 0): p-value=0.00781
</pre></div>
</div>
<img alt="_images/db47115a73ccf386d4aaa1738c13b3257b0a8b076d020d271002eb9960effe66.png" src="_images/db47115a73ccf386d4aaa1738c13b3257b0a8b076d020d271002eb9960effe66.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Trend Analysis Result (Median Slope &gt; 0): p-value=0.00781
</pre></div>
</div>
<img alt="_images/0a93e006300446c9faec6b009ffff29216e33773069cbcfc95a3d7ac33d5dc83.png" src="_images/0a93e006300446c9faec6b009ffff29216e33773069cbcfc95a3d7ac33d5dc83.png" />
</div>
</div>
</section>
</section>
<section id="extended-data-figure-8">
<h3>Extended Data Figure 8<a class="headerlink" href="#extended-data-figure-8" title="Permalink to this heading">#</a></h3>
<p><a id="ext_data_fig_8"></a></p>
<section id="a-c">
<h4>a — c<a class="headerlink" href="#a-c" title="Permalink to this heading">#</a></h4>
<p>Comparing across learning and retraining to check consolidation in Motor Learning vs Paired VNS animals</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ==========================================</span>
<span class="c1"># 1. SHARED HELPER FUNCTIONS</span>
<span class="c1"># ==========================================</span>
<span class="c1"># --- Data Extraction ---</span>
<span class="k">def</span> <span class="nf">extract_daily_matrix</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">filter_names</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">filter_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">target_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">target_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">filter_names</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">]</span>
    
    <span class="n">matrix</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">target_keys</span><span class="p">:</span>
        <span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">matrix</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arr</span><span class="p">[:</span><span class="mi">7</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">calculate_sliding_auc</span><span class="p">(</span><span class="n">data_dict</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">filter_names</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">filter_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">target_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">data_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">target_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">filter_names</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="p">]</span>
    
    <span class="n">n_days</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">n_windows</span> <span class="o">=</span> <span class="p">(</span><span class="n">n_days</span> <span class="o">-</span> <span class="n">window_size</span><span class="p">)</span> <span class="o">//</span> <span class="n">stride</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">window_data</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_windows</span><span class="p">)]</span>
    
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">target_keys</span><span class="p">:</span>
        <span class="n">trace</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">trace</span> <span class="o">=</span> <span class="n">trace</span><span class="p">[:</span><span class="mi">7</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_windows</span><span class="p">):</span>
                <span class="n">start</span> <span class="o">=</span> <span class="n">w</span> <span class="o">*</span> <span class="n">stride</span>
                <span class="n">end</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">window_size</span>
                <span class="n">segment</span> <span class="o">=</span> <span class="n">trace</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]</span>
                <span class="n">auc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">segment</span><span class="p">,</span> <span class="n">dx</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">window_data</span><span class="p">[</span><span class="n">w</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">auc</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">window_data</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">extract_paired_data</span><span class="p">(</span><span class="n">learning_dict</span><span class="p">,</span> <span class="n">retraining_dict</span><span class="p">,</span> <span class="n">filter_names</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">filter_names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">target_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">learning_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span> <span class="n">target_keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">filter_names</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">learning_dict</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">retraining_dict</span><span class="p">]</span>
    
    <span class="n">l_vals</span><span class="p">,</span> <span class="n">r_vals</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">target_keys</span><span class="p">:</span>
        <span class="n">l_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">learning_dict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="n">r_arr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">retraining_dict</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">l_arr</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">7</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_arr</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">l_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">l_arr</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">7</span><span class="p">]))</span> 
            <span class="n">r_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">r_arr</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">l_vals</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r_vals</span><span class="p">)</span>

<span class="c1"># --- Bootstrapping Logic ---</span>

<span class="k">def</span> <span class="nf">run_bootstrap_window_stats</span><span class="p">(</span><span class="n">ml_wins</span><span class="p">,</span> <span class="n">vns_wins</span><span class="p">,</span> <span class="n">n_boot</span><span class="p">):</span>
    <span class="n">n_windows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ml_wins</span><span class="p">)</span>
    <span class="n">p_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_windows</span><span class="p">):</span>
        <span class="n">curr_ml</span><span class="p">,</span> <span class="n">curr_vns</span> <span class="o">=</span> <span class="n">ml_wins</span><span class="p">[</span><span class="n">w</span><span class="p">],</span> <span class="n">vns_wins</span><span class="p">[</span><span class="n">w</span><span class="p">]</span>
        <span class="n">iter_p</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_boot</span><span class="p">):</span>
            <span class="n">r_ml</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">curr_ml</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">curr_ml</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">r_vns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">curr_vns</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">curr_vns</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span> <span class="n">_</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">r_ml</span><span class="p">,</span> <span class="n">r_vns</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span> <span class="n">p</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">iter_p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">p_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">iter_p</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">p_values</span>

<span class="k">def</span> <span class="nf">bootstrap_test_paired</span><span class="p">(</span><span class="n">data_a</span><span class="p">,</span> <span class="n">data_b</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">):</span>
    <span class="n">obs_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_b</span> <span class="o">-</span> <span class="n">data_a</span><span class="p">)</span>
    <span class="n">diffs</span> <span class="o">=</span> <span class="n">data_b</span> <span class="o">-</span> <span class="n">data_a</span>
    <span class="n">null_means</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_boot</span><span class="p">):</span>
        <span class="n">signs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">diffs</span><span class="p">))</span>
        <span class="n">null_means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">diffs</span> <span class="o">*</span> <span class="n">signs</span><span class="p">))</span>
    <span class="n">null_means</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">null_means</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">alternative</span> <span class="o">==</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">null_means</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">obs_diff</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="o">==</span> <span class="s1">&#39;less&#39;</span><span class="p">:</span> 
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">null_means</span> <span class="o">&lt;=</span> <span class="n">obs_diff</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">alternative</span> <span class="o">==</span> <span class="s1">&#39;greater&#39;</span><span class="p">:</span> 
        <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">null_means</span> <span class="o">&gt;=</span> <span class="n">obs_diff</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">p</span>

<span class="k">def</span> <span class="nf">bootstrap_test_indep</span><span class="p">(</span><span class="n">data_a</span><span class="p">,</span> <span class="n">data_b</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
    <span class="n">obs_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_a</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_b</span><span class="p">)</span>
    <span class="n">pooled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">data_a</span><span class="p">,</span> <span class="n">data_b</span><span class="p">])</span>
    <span class="n">null_diffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_boot</span><span class="p">):</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">pooled</span><span class="p">)</span>
        <span class="n">null_diffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">pooled</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">data_a</span><span class="p">)])</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">pooled</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">data_a</span><span class="p">):]))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">null_diffs</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">obs_diff</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">bootstrap_mean_distribution</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
    <span class="n">means</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_boot</span><span class="p">):</span>
        <span class="n">means</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">means</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">bootstrap_proportion_diff</span><span class="p">(</span><span class="n">ml_data</span><span class="p">,</span> <span class="n">vns_data</span><span class="p">,</span> <span class="n">n_boot</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=-</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">diffs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_boot</span><span class="p">):</span>
        <span class="n">r_ml</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">ml_data</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ml_data</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">r_vns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">vns_data</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">vns_data</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">p_ml</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r_ml</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">ml_data</span><span class="p">)</span>
        <span class="n">p_vns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r_vns</span> <span class="o">&lt;</span> <span class="n">threshold</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">vns_data</span><span class="p">)</span>
        <span class="n">diffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_ml</span> <span class="o">-</span> <span class="n">p_vns</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">diffs</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_boot</span>

<span class="k">def</span> <span class="nf">calculate_probability_of_superiority</span><span class="p">(</span><span class="n">ml_dist</span><span class="p">,</span> <span class="n">vns_dist</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vns_dist</span> <span class="o">&gt;</span> <span class="n">ml_dist</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">ml_dist</span><span class="p">)</span>

<span class="c1"># ==========================================</span>
<span class="c1"># 2. MAIN 3-PANEL PLOTTING FUNCTION</span>
<span class="c1"># ==========================================</span>

<span class="k">def</span> <span class="nf">plot_combined_manuscript_figure</span><span class="p">(</span>
    <span class="n">ml_learn</span><span class="p">,</span> <span class="n">ml_retrain</span><span class="p">,</span> <span class="n">vns_learn</span><span class="p">,</span> <span class="n">vns_retrain</span><span class="p">,</span>
    <span class="n">ml_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vns_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">save_filename</span><span class="o">=</span><span class="s2">&quot;final_3panel_figure_custom.pdf&quot;</span><span class="p">,</span>
    <span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num_bootstraps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
    <span class="n">stability_threshold</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">group_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Motor Learning&#39;</span><span class="p">,</span> <span class="s1">&#39;Paired VNS&#39;</span><span class="p">],</span>
    <span class="n">group_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#8da3a3ff&#39;</span><span class="p">,</span> <span class="s1">&#39;#0a60ffff&#39;</span><span class="p">],</span>
    <span class="n">prob_sup_text</span><span class="o">=</span><span class="s2">&quot;Pr(</span><span class="si">{}</span><span class="s2"> &gt; </span><span class="si">{}</span><span class="s2">) = </span><span class="si">{:.1f}</span><span class="s2">%&quot;</span>
<span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;--- Generating 3-Panel Figure (</span><span class="si">{</span><span class="n">num_bootstraps</span><span class="si">}</span><span class="s2"> bootstraps) ---&quot;</span><span class="p">)</span>
    
    <span class="c1"># Assign names and colors for clarity</span>
    <span class="n">name_ml</span><span class="p">,</span> <span class="n">name_vns</span> <span class="o">=</span> <span class="n">group_names</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">group_names</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">c_ml</span><span class="p">,</span> <span class="n">c_vns</span> <span class="o">=</span> <span class="n">group_colors</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">group_colors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># --- A. Prepare Data ---</span>
    <span class="n">ml_mat</span> <span class="o">=</span> <span class="n">extract_daily_matrix</span><span class="p">(</span><span class="n">ml_retrain</span><span class="p">,</span> <span class="n">ml_names</span><span class="p">)</span>
    <span class="n">vns_mat</span> <span class="o">=</span> <span class="n">extract_daily_matrix</span><span class="p">(</span><span class="n">vns_retrain</span><span class="p">,</span> <span class="n">vns_names</span><span class="p">)</span>
    <span class="n">ml_wins</span> <span class="o">=</span> <span class="n">calculate_sliding_auc</span><span class="p">(</span><span class="n">ml_retrain</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ml_names</span><span class="p">)</span>
    <span class="n">vns_wins</span> <span class="o">=</span> <span class="n">calculate_sliding_auc</span><span class="p">(</span><span class="n">vns_retrain</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">vns_names</span><span class="p">)</span>
    
    <span class="n">ml_l7</span><span class="p">,</span> <span class="n">ml_re</span> <span class="o">=</span> <span class="n">extract_paired_data</span><span class="p">(</span><span class="n">ml_learn</span><span class="p">,</span> <span class="n">ml_retrain</span><span class="p">,</span> <span class="n">ml_names</span><span class="p">)</span>
    <span class="n">vns_l7</span><span class="p">,</span> <span class="n">vns_re</span> <span class="o">=</span> <span class="n">extract_paired_data</span><span class="p">(</span><span class="n">vns_learn</span><span class="p">,</span> <span class="n">vns_retrain</span><span class="p">,</span> <span class="n">vns_names</span><span class="p">)</span>
    <span class="n">ml_deltas</span> <span class="o">=</span> <span class="n">ml_re</span> <span class="o">-</span> <span class="n">ml_l7</span>
    <span class="n">vns_deltas</span> <span class="o">=</span> <span class="n">vns_re</span> <span class="o">-</span> <span class="n">vns_l7</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ml_l7</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: No data found&quot;</span><span class="p">);</span> <span class="k">return</span>

    <span class="c1"># --- B. Run Statistics ---</span>
    
    <span class="c1"># Panel 1 Stats (Sliding AUC)</span>
    <span class="k">if</span> <span class="n">bootstrap</span><span class="p">:</span>
        <span class="n">p_auc</span> <span class="o">=</span> <span class="n">run_bootstrap_window_stats</span><span class="p">(</span><span class="n">ml_wins</span><span class="p">,</span> <span class="n">vns_wins</span><span class="p">,</span> <span class="n">num_bootstraps</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p_auc</span> <span class="o">=</span> <span class="p">[</span><span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">ml_wins</span><span class="p">[</span><span class="n">w</span><span class="p">],</span> <span class="n">vns_wins</span><span class="p">[</span><span class="n">w</span><span class="p">])</span><span class="o">.</span><span class="n">pvalue</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ml_wins</span><span class="p">))]</span>
        
    <span class="c1"># Panel 2 Stats (Paired)</span>
    <span class="k">if</span> <span class="n">bootstrap</span><span class="p">:</span>
        <span class="n">p_ml_2tail</span> <span class="o">=</span> <span class="n">bootstrap_test_paired</span><span class="p">(</span><span class="n">ml_l7</span><span class="p">,</span> <span class="n">ml_re</span><span class="p">,</span> <span class="n">num_bootstraps</span><span class="p">,</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>
        <span class="n">p_ml_1tail</span> <span class="o">=</span> <span class="n">bootstrap_test_paired</span><span class="p">(</span><span class="n">ml_l7</span><span class="p">,</span> <span class="n">ml_re</span><span class="p">,</span> <span class="n">num_bootstraps</span><span class="p">,</span> <span class="s1">&#39;less&#39;</span><span class="p">)</span>
        <span class="n">p_vns_2tail</span> <span class="o">=</span> <span class="n">bootstrap_test_paired</span><span class="p">(</span><span class="n">vns_l7</span><span class="p">,</span> <span class="n">vns_re</span><span class="p">,</span> <span class="n">num_bootstraps</span><span class="p">,</span> <span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>
        <span class="n">p_vns_1tail</span> <span class="o">=</span> <span class="n">bootstrap_test_paired</span><span class="p">(</span><span class="n">vns_l7</span><span class="p">,</span> <span class="n">vns_re</span><span class="p">,</span> <span class="n">num_bootstraps</span><span class="p">,</span> <span class="s1">&#39;less&#39;</span><span class="p">)</span>
        <span class="n">p_bw_re</span> <span class="o">=</span> <span class="n">bootstrap_test_indep</span><span class="p">(</span><span class="n">ml_re</span><span class="p">,</span> <span class="n">vns_re</span><span class="p">,</span> <span class="n">num_bootstraps</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">p_ml_2tail</span> <span class="o">=</span> <span class="n">wilcoxon</span><span class="p">(</span><span class="n">ml_l7</span><span class="p">,</span> <span class="n">ml_re</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">p_ml_1tail</span> <span class="o">=</span> <span class="n">wilcoxon</span><span class="p">(</span><span class="n">ml_l7</span><span class="p">,</span> <span class="n">ml_re</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;less&#39;</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">p_vns_2tail</span> <span class="o">=</span> <span class="n">wilcoxon</span><span class="p">(</span><span class="n">vns_l7</span><span class="p">,</span> <span class="n">vns_re</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;two-sided&#39;</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">p_vns_1tail</span> <span class="o">=</span> <span class="n">wilcoxon</span><span class="p">(</span><span class="n">vns_l7</span><span class="p">,</span> <span class="n">vns_re</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;less&#39;</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">p_bw_re</span> <span class="o">=</span> <span class="n">mannwhitneyu</span><span class="p">(</span><span class="n">ml_re</span><span class="p">,</span> <span class="n">vns_re</span><span class="p">)</span>
        
    <span class="c1"># Panel 3 Stats (Custom Threshold)</span>
    <span class="n">p_prop_diff</span> <span class="o">=</span> <span class="n">bootstrap_proportion_diff</span><span class="p">(</span><span class="n">ml_deltas</span><span class="p">,</span> <span class="n">vns_deltas</span><span class="p">,</span> <span class="n">num_bootstraps</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="n">stability_threshold</span><span class="p">)</span>
    
    <span class="n">ml_boot_dist</span> <span class="o">=</span> <span class="n">bootstrap_mean_distribution</span><span class="p">(</span><span class="n">ml_deltas</span><span class="p">,</span> <span class="n">num_bootstraps</span><span class="p">)</span>
    <span class="n">vns_boot_dist</span> <span class="o">=</span> <span class="n">bootstrap_mean_distribution</span><span class="p">(</span><span class="n">vns_deltas</span><span class="p">,</span> <span class="n">num_bootstraps</span><span class="p">)</span>
    
    <span class="n">prob_stable_ml</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ml_boot_dist</span> <span class="o">&gt;=</span> <span class="n">stability_threshold</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">ml_boot_dist</span><span class="p">)</span>
    <span class="n">prob_stable_vns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">vns_boot_dist</span> <span class="o">&gt;=</span> <span class="n">stability_threshold</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">vns_boot_dist</span><span class="p">)</span>
    <span class="n">prob_sup</span> <span class="o">=</span> <span class="n">calculate_probability_of_superiority</span><span class="p">(</span><span class="n">ml_boot_dist</span><span class="p">,</span> <span class="n">vns_boot_dist</span><span class="p">)</span>
    
    <span class="n">ml_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">ml_boot_dist</span><span class="p">,</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">])</span>
    <span class="n">vns_ci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">vns_boot_dist</span><span class="p">,</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">])</span>
    <span class="n">ml_mean_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">ml_boot_dist</span><span class="p">)</span>
    <span class="n">vns_mean_est</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">vns_boot_dist</span><span class="p">)</span>

    <span class="c1"># --- C. Plotting Setup ---</span>
    <span class="n">npl</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="n">font</span><span class="o">=</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="n">font_scale</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
          <span class="n">rc</span><span class="o">=</span><span class="p">({</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="s1">&#39;font.size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;axes.labelsize&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> 
               <span class="s1">&#39;axes.titlesize&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;legend.fontsize&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> 
               <span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;pdf.fonttype&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span> <span class="s1">&#39;ps.fonttype&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
               <span class="s1">&#39;figure.facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;axes.facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span>
               <span class="s1">&#39;savefig.facecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="s1">&#39;text.color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
               <span class="s1">&#39;axes.labelcolor&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;xtick.color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
               <span class="s1">&#39;ytick.color&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;axes.edgecolor&#39;</span><span class="p">:</span> <span class="s1">&#39;black&#39;</span>
               <span class="p">}))</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">gridspec_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;width_ratios&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
    
    <span class="c1"># ===================================================</span>
    <span class="c1"># PANEL A: Daily Trace</span>
    <span class="c1"># ===================================================</span>
    <span class="n">days</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
    <span class="n">ml_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">ml_mat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span> <span class="n">ml_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanstd</span><span class="p">(</span><span class="n">ml_mat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ml_mat</span><span class="p">))</span>
    <span class="n">vns_m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmean</span><span class="p">(</span><span class="n">vns_mat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">);</span> <span class="n">vns_s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanstd</span><span class="p">(</span><span class="n">vns_mat</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vns_mat</span><span class="p">))</span>
    
    <span class="n">ax1</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">days</span><span class="p">,</span> <span class="n">ml_m</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">ml_s</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c_ml</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name_ml</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">days</span><span class="p">,</span> <span class="n">vns_m</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">vns_s</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c_vns</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">elinewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">name_vns</span><span class="p">)</span>
    
    <span class="n">y_max</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ml_m</span><span class="o">+</span><span class="n">ml_s</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">vns_m</span><span class="o">+</span><span class="n">vns_s</span><span class="p">))</span>
    <span class="n">base_h</span> <span class="o">=</span> <span class="n">y_max</span> <span class="o">+</span> <span class="mi">5</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p_auc</span><span class="p">):</span>
        <span class="n">stars</span> <span class="o">=</span> <span class="n">get_stars</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">stars</span> <span class="o">!=</span> <span class="s1">&#39;ns&#39;</span><span class="p">:</span>
            <span class="n">s_d</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span> <span class="n">e_d</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span>
            <span class="n">h</span> <span class="o">=</span> <span class="n">base_h</span> <span class="o">+</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">s_d</span><span class="p">,</span> <span class="n">e_d</span><span class="p">],</span> <span class="p">[</span><span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">s_d</span><span class="p">,</span> <span class="n">s_d</span><span class="p">],</span> <span class="p">[</span><span class="n">h</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">h</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">e_d</span><span class="p">,</span> <span class="n">e_d</span><span class="p">],</span> <span class="p">[</span><span class="n">h</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">h</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="n">s_d</span><span class="o">+</span><span class="n">e_d</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">h</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">stars</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
            
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Retraining (Days)&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Success Rate (%)&quot;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">base_h</span> <span class="o">+</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">days</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">);</span> <span class="n">ax1</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;A. Retraining Performance&quot;</span><span class="p">)</span>

    <span class="c1"># ===================================================</span>
    <span class="c1"># PANEL B: Paired Comparisons</span>
    <span class="c1"># ===================================================</span>
    <span class="n">x_ml</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">];</span> <span class="n">x_vns</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ml_l7</span><span class="p">,</span> <span class="n">ml_re</span><span class="p">):</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_ml</span><span class="p">,</span> <span class="p">[</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">],</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">mfc</span><span class="o">=</span><span class="n">c_ml</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="n">c_ml</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">vns_l7</span><span class="p">,</span> <span class="n">vns_re</span><span class="p">):</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vns</span><span class="p">,</span> <span class="p">[</span><span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">],</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">mfc</span><span class="o">=</span><span class="n">c_vns</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="n">c_vns</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
    <span class="n">all_v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">ml_l7</span><span class="p">,</span> <span class="n">ml_re</span><span class="p">,</span> <span class="n">vns_l7</span><span class="p">,</span> <span class="n">vns_re</span><span class="p">])</span>
    <span class="n">h_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">all_v</span><span class="p">)</span>
    
    <span class="n">h_ml</span> <span class="o">=</span> <span class="n">h_max</span> <span class="o">+</span> <span class="mi">10</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">h_ml</span><span class="p">,</span> <span class="n">h_ml</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="n">h_ml</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">h_ml</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">h_ml</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">h_ml</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">ml_star</span> <span class="o">=</span> <span class="n">get_stars</span><span class="p">(</span><span class="n">p_ml_1tail</span><span class="p">)</span>
    <span class="n">p_text_ml</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;2-tail: </span><span class="si">{</span><span class="n">format_pvalue</span><span class="p">(</span><span class="n">p_ml_2tail</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s2">1-tail (Diff &lt; 0): </span><span class="si">{</span><span class="n">ml_star</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">h_ml</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">p_text_ml</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">linespacing</span><span class="o">=</span><span class="mf">1.2</span><span class="p">)</span>
    
    <span class="n">h_bw</span> <span class="o">=</span> <span class="n">h_max</span> <span class="o">+</span> <span class="mi">25</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="n">h_bw</span><span class="p">,</span> <span class="n">h_bw</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="n">h_bw</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">h_bw</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="n">h_bw</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">h_bw</span><span class="p">],</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="n">h_bw</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">get_stars</span><span class="p">(</span><span class="n">p_bw_re</span><span class="p">),</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">]);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">name_ml</span><span class="p">,</span> <span class="n">name_vns</span><span class="p">])</span> <span class="c1"># Custom Labels</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;Learn</span><span class="se">\n</span><span class="s2">Days 6-7&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;Retrain</span><span class="se">\n</span><span class="s2">Days 2-3&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;Learn</span><span class="se">\n</span><span class="s2">Days 6-7&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="s2">&quot;Retrain</span><span class="se">\n</span><span class="s2">Days 2-3&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
    
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">h_bw</span><span class="o">+</span><span class="mi">20</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Success Rate (%)&quot;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;B. Individual Retention&quot;</span><span class="p">)</span>

    <span class="c1"># ===================================================</span>
    <span class="c1"># PANEL C: Split Violin</span>
    <span class="c1"># ===================================================</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">stability_threshold</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    
    <span class="n">v_ml</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">ml_boot_dist</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">showextrema</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">widths</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">v_vns</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">vns_boot_dist</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">showextrema</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">widths</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">v_ml</span><span class="p">[</span><span class="s1">&#39;bodies&#39;</span><span class="p">]:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">get_paths</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">b</span><span class="o">.</span><span class="n">get_paths</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">get_paths</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
        <span class="n">b</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">c_ml</span><span class="p">);</span> <span class="n">b</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">);</span> <span class="n">b</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">v_vns</span><span class="p">[</span><span class="s1">&#39;bodies&#39;</span><span class="p">]:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">get_paths</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">b</span><span class="o">.</span><span class="n">get_paths</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">get_paths</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vertices</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">m</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
        <span class="n">b</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="n">c_vns</span><span class="p">);</span> <span class="n">b</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s1">&#39;None&#39;</span><span class="p">);</span> <span class="n">b</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
        
    <span class="n">ax3</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ml_deltas</span><span class="p">)),</span> <span class="n">ml_deltas</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c_ml</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">vns_deltas</span><span class="p">)),</span> <span class="n">vns_deltas</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c_vns</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">ec</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="n">ax3</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">ml_mean_est</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="p">[[</span><span class="n">ml_mean_est</span><span class="o">-</span><span class="n">ml_ci</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">ml_ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">ml_mean_est</span><span class="p">]],</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">vns_mean_est</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="p">[[</span><span class="n">vns_mean_est</span><span class="o">-</span><span class="n">vns_ci</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="p">[</span><span class="n">vns_ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">vns_mean_est</span><span class="p">]],</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    
    <span class="c1"># --- PROBABILITY TEXT ---</span>
    <span class="n">y_ci_text_ml</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">ml_ci</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">ml_deltas</span><span class="p">))</span> <span class="o">-</span> <span class="mi">5</span>
    <span class="n">ml_prob_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Stable (&gt;</span><span class="si">{</span><span class="n">stability_threshold</span><span class="si">}</span><span class="s2">%)</span><span class="se">\n</span><span class="si">{</span><span class="n">prob_stable_ml</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">y_ci_text_ml</span><span class="p">,</span> <span class="n">ml_prob_text</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c_ml</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    
    <span class="n">y_ci_text_vns</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">vns_ci</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">vns_deltas</span><span class="p">))</span> <span class="o">-</span> <span class="mi">5</span>
    <span class="n">vns_prob_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Stable (&gt;</span><span class="si">{</span><span class="n">stability_threshold</span><span class="si">}</span><span class="s2">%)</span><span class="se">\n</span><span class="si">{</span><span class="n">prob_stable_vns</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">y_ci_text_vns</span><span class="p">,</span> <span class="n">vns_prob_text</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">c_vns</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="c1"># --- TOP LABEL: PROBABILITY OF SUPERIORITY ---</span>
    <span class="n">y_top</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ml_deltas</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">vns_deltas</span><span class="p">))</span> <span class="o">+</span> <span class="mi">5</span>
    <span class="c1"># Use format strings for custom text with group names</span>
    <span class="c1"># Note: name_vns is usually &#39;better&#39; so it is {name_vns} &gt; {name_ml}</span>
    <span class="n">cles_label</span> <span class="o">=</span> <span class="n">prob_sup_text</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name_vns</span><span class="p">,</span> <span class="n">name_ml</span><span class="p">,</span> <span class="n">prob_sup</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span> 
    <span class="n">ax3</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">y_top</span><span class="p">,</span> <span class="n">cles_label</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">]);</span> <span class="n">ax3</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">name_ml</span><span class="p">,</span> <span class="n">name_vns</span><span class="p">])</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Retention Delta (%)</span><span class="se">\n</span><span class="s2">(Retrain D2-3 - Learn D6-7)&quot;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">)</span>
    
    <span class="n">y_bottom_limit</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">y_ci_text_ml</span><span class="p">,</span> <span class="n">y_ci_text_vns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">15</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y_bottom_limit</span><span class="p">,</span> <span class="n">y_top</span><span class="o">+</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">);</span> <span class="n">ax3</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;C. 95% CI of Change&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">if</span><span class="p">(</span><span class="n">save_filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_filename</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;pdf&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    <span class="c1"># ==========================================</span>
    <span class="c1"># STATISTICS TABLE OUTPUT</span>
    <span class="c1"># ==========================================</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;STATISTICAL REPORT FOR TABLE GENERATION&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-----------------------------------------------------------&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PANEL A: Longitudinal Performance (Sliding Window AUC)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test: Bootstrapped Mann-Whitney U (Independent)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------------------&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">p_auc</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Window </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2"> (Day </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">format_pvalue</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">get_stars</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-----------------------------------------------------------&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PANEL B: Within-Group Retention (Paired)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test: Bootstrapped Paired Wilcoxon (Pre vs Post)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------------------&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name_ml</span><span class="si">}</span><span class="s2"> (N=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ml_l7</span><span class="p">)</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  2-Tailed (Change): </span><span class="si">{</span><span class="n">format_pvalue</span><span class="p">(</span><span class="n">p_ml_2tail</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  1-Tailed (Drop):   </span><span class="si">{</span><span class="n">format_pvalue</span><span class="p">(</span><span class="n">p_ml_1tail</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name_vns</span><span class="si">}</span><span class="s2"> (N=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">vns_l7</span><span class="p">)</span><span class="si">}</span><span class="s2">):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  2-Tailed (Change): </span><span class="si">{</span><span class="n">format_pvalue</span><span class="p">(</span><span class="n">p_vns_2tail</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  1-Tailed (Drop):   </span><span class="si">{</span><span class="n">format_pvalue</span><span class="p">(</span><span class="n">p_vns_1tail</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-----------------------------------------------------------&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PANEL B: Between-Group Retention (Independent)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test: Bootstrapped Mann-Whitney U&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------------------&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Early Retraining (</span><span class="si">{</span><span class="n">name_ml</span><span class="si">}</span><span class="s2"> vs </span><span class="si">{</span><span class="n">name_vns</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">format_pvalue</span><span class="p">(</span><span class="n">p_bw_re</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-----------------------------------------------------------&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;PANEL C: Retention Delta &amp; Distribution Shift&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test: Bootstrapped Proportion Difference (Threshold: &gt; </span><span class="si">{</span><span class="n">stability_threshold</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-----------------------------------------------------------&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Proportion Forgetting Difference (p-value): </span><span class="si">{</span><span class="n">p_prop_diff</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Probability of Superiority (</span><span class="si">{</span><span class="n">name_vns</span><span class="si">}</span><span class="s2"> &gt; </span><span class="si">{</span><span class="n">name_ml</span><span class="si">}</span><span class="s2">):      </span><span class="si">{</span><span class="n">prob_sup</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prob. Stable </span><span class="si">{</span><span class="n">name_ml</span><span class="si">}</span><span class="s2"> (Delta &gt;= </span><span class="si">{</span><span class="n">stability_threshold</span><span class="si">}</span><span class="s2">%):            </span><span class="si">{</span><span class="n">prob_stable_ml</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prob. Stable </span><span class="si">{</span><span class="n">name_vns</span><span class="si">}</span><span class="s2"> (Delta &gt;= </span><span class="si">{</span><span class="n">stability_threshold</span><span class="si">}</span><span class="s2">%):           </span><span class="si">{</span><span class="n">prob_stable_vns</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name_ml</span><span class="si">}</span><span class="s2"> 95% CI: [</span><span class="si">{</span><span class="n">ml_ci</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">ml_ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name_vns</span><span class="si">}</span><span class="s2"> 95% CI:     [</span><span class="si">{</span><span class="n">vns_ci</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">vns_ci</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># --- USAGE EXAMPLE ---</span>
<span class="n">plot_combined_manuscript_figure</span><span class="p">(</span>
    <span class="n">all_mice_data_motorlearning_learning</span><span class="p">,</span> <span class="n">all_mice_data_motorlearning_retraining</span><span class="p">,</span>
    <span class="n">all_mice_data_pairedVNS_learning</span><span class="p">,</span> <span class="n">all_mice_data_pairedVNS_retraining</span><span class="p">,</span>
    <span class="n">num_bootstraps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span>
    <span class="n">save_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">stability_threshold</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">group_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Motor Learning&#39;</span><span class="p">,</span> <span class="s1">&#39;Paired VNS&#39;</span><span class="p">],</span>
    <span class="n">group_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#8da3a3ff&#39;</span><span class="p">,</span> <span class="s1">&#39;#0a60ffff&#39;</span><span class="p">],</span>
    <span class="n">prob_sup_text</span><span class="o">=</span><span class="s2">&quot;Prob(</span><span class="si">{}</span><span class="s2"> &gt; </span><span class="si">{}</span><span class="s2">) = </span><span class="si">{:.1f}</span><span class="s2">%&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Generating 3-Panel Figure (10000 bootstraps) ---
</pre></div>
</div>
<img alt="_images/762629ba78ba83d214334b61ff5dbf81ce04c0a13a7952dcd2b107385d4b119e.png" src="_images/762629ba78ba83d214334b61ff5dbf81ce04c0a13a7952dcd2b107385d4b119e.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>============================================================
STATISTICAL REPORT FOR TABLE GENERATION
============================================================

-----------------------------------------------------------
PANEL A: Longitudinal Performance (Sliding Window AUC)
Test: Bootstrapped Mann-Whitney U (Independent)
-----------------------------------------------------------
Window 1 (Day 1-2): p = 0.125 (ns)
Window 2 (Day 2-3): p = 0.030 (*)
Window 3 (Day 3-4): p = 0.109 (ns)
Window 4 (Day 4-5): p = 0.125 (ns)
Window 5 (Day 5-6): p = 0.152 (ns)
Window 6 (Day 6-7): p = 0.059 (ns)

-----------------------------------------------------------
PANEL B: Within-Group Retention (Paired)
Test: Bootstrapped Paired Wilcoxon (Pre vs Post)
-----------------------------------------------------------
Motor Learning (N=12):
  2-Tailed (Change): p = 0.078
  1-Tailed (Drop):   p = 0.041
Paired VNS (N=9):
  2-Tailed (Change): p = 0.439
  1-Tailed (Drop):   p = 0.226

-----------------------------------------------------------
PANEL B: Between-Group Retention (Independent)
Test: Bootstrapped Mann-Whitney U
-----------------------------------------------------------
Early Retraining (Motor Learning vs Paired VNS): p = 0.034

-----------------------------------------------------------
PANEL C: Retention Delta &amp; Distribution Shift
Test: Bootstrapped Proportion Difference (Threshold: &gt; -5%)
-----------------------------------------------------------
Proportion Forgetting Difference (p-value): 0.4697
Probability of Superiority (Paired VNS &gt; Motor Learning):      74.0%
Prob. Stable Motor Learning (Delta &gt;= -5%):            23.2%
Prob. Stable Paired VNS (Delta &gt;= -5%):           59.0%
Motor Learning 95% CI: [-14.58, -0.24]
Paired VNS 95% CI:     [-12.81, 4.99]
============================================================
</pre></div>
</div>
</div>
</div>
<p>Statistical Methodology Summary:</p>
<ul class="simple">
<li><p>Panel A (Longitudinal): Sliding Window AUC comparison using Mann-Whitney U tests (or bootstrapped equivalent) corrected for multiple comparisons if necessary (raw p-values provided below).</p></li>
<li><p>Panel B (Within-Group): Bootstrapped Paired Tests (equivalent to Wilcoxon Signed-Rank). We report both Two-Tailed (standard significance) and One-Tailed (directional hypothesis of forgetting) p-values.</p></li>
<li><p>Panel B (Between-Group): Bootstrapped Independent Tests (equivalent to Mann-Whitney U) comparing the early retraining performance.</p></li>
<li><p>Panel C (Distribution Shift): Bootstrapped Proportion Difference Test (comparing the likelihood of <span class="math notranslate nohighlight">\(\Delta &lt; 0\)</span>) and Probability of Superiority (common language effect size).</p></li>
</ul>
<div class="alert alert-block alert-success">
    <b>Statistical Insight: Long-Term Functional Recovery</b><br>
    The retrieval phase analysis confirms that Paired VNS confers a lasting functional benefit driven by two distinct mechanisms:
    <ul>
        <li><b>Accelerated Re-attainment:</b> While initial success rates were comparable, Paired VNS mice exhibited significantly accelerated re-acquisition of motor proficiency (<b>AUC Days 2–3, p=0.030</b>; <i>see Extended Data Fig. 8a</i>) and continued to improve across the sessions.</li>
        <li><b>Superior Consolidation:</b> Motor Learning controls plateaued and showed significant performance decay over the 10-week hiatus (<b>p=0.037</b>). In contrast, Paired VNS mice maintained remarkable stability, mirroring their late-learning proficiency (<b>p=0.448</b>; <i>see Extended Data Fig. 8b</i>).</li>
        <li><b>Robust Advantage:</b> This results in a <b>74.1% probability</b> that a random Paired VNS mouse will outperform a control mouse during the retrieval phase (<i>see Extended Data Fig. 8c</i>).</li>
    </ul>
    <b>Conclusion:</b> The functional recovery observed in Panel B is not just transient; Paired VNS prevents the "forgetting" observed in controls and facilitates rapid recall of the motor skill weeks after stimulation has ceased.
</div><p><a id="#ext_data_fig_8d_f"></a></p>
</section>
<section id="d-f">
<h4>d — f<a class="headerlink" href="#d-f" title="Permalink to this heading">#</a></h4>
<p><strong>Adaptive myelination is required to stabilize the motor memory.</strong> To confirm that the functional stability observed in the VNS group requires new oligodendrocytes, we compared <em>Myrf</em> WT (Cre-) and <em>Myrf</em> cKO (Cre+) mice.</p>
<ul class="simple">
<li><p><strong>Panel d:</strong> Longitudinal analysis of retrieval performance.</p></li>
<li><p><strong>Panel e:</strong> Paired retention analysis (Learning Day 6-7 vs. Retrieval Day 2-3).</p></li>
<li><p><strong>Panel f:</strong> Distribution of retention stability (Delta &gt; -5%).</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_combined_manuscript_figure</span><span class="p">(</span>
    <span class="c1"># Data Groups (Control = WT, Exp = cKO)</span>
    <span class="n">ml_learn</span><span class="o">=</span><span class="n">all_mice_data_creNegative_learning</span><span class="p">,</span>
    <span class="n">ml_retrain</span><span class="o">=</span><span class="n">all_mice_data_creNegative_retraining</span><span class="p">,</span>
    <span class="n">vns_learn</span><span class="o">=</span><span class="n">all_mice_data_crePositive_learning</span><span class="p">,</span>
    <span class="n">vns_retrain</span><span class="o">=</span><span class="n">all_mice_data_crePositive_retraining</span><span class="p">,</span>   

    
    <span class="c1"># Customization Parameters</span>
    <span class="n">save_filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">group_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Myrf WT&#39;</span><span class="p">,</span> <span class="s1">&#39;Myrf cKO&#39;</span><span class="p">],</span>
    <span class="n">group_colors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;#d8a6a6ff&#39;</span><span class="p">,</span> <span class="s1">&#39;#a00000ff&#39;</span><span class="p">],</span> <span class="c1"># WT (Light), cKO (Dark)</span>
    <span class="n">stability_threshold</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span>
    <span class="n">num_bootstraps</span><span class="o">=</span><span class="mi">10000</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--- Generating 3-Panel Figure (10000 bootstraps) ---
</pre></div>
</div>
<img alt="_images/521a90eb524f5055a44dbd15c15712d8b528b85704c93f85c6f935e3aa395482.png" src="_images/521a90eb524f5055a44dbd15c15712d8b528b85704c93f85c6f935e3aa395482.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>============================================================
STATISTICAL REPORT FOR TABLE GENERATION
============================================================

-----------------------------------------------------------
PANEL A: Longitudinal Performance (Sliding Window AUC)
Test: Bootstrapped Mann-Whitney U (Independent)
-----------------------------------------------------------
Window 1 (Day 1-2): p = 0.458 (ns)
Window 2 (Day 2-3): p = 0.026 (*)
Window 3 (Day 3-4): p = 0.240 (ns)
Window 4 (Day 4-5): p = 0.338 (ns)
Window 5 (Day 5-6): p = 0.522 (ns)
Window 6 (Day 6-7): p = 0.523 (ns)

-----------------------------------------------------------
PANEL B: Within-Group Retention (Paired)
Test: Bootstrapped Paired Wilcoxon (Pre vs Post)
-----------------------------------------------------------
Myrf WT (N=9):
  2-Tailed (Change): p = 0.469
  1-Tailed (Drop):   p = 0.240
Myrf cKO (N=7):
  2-Tailed (Change): p = 0.017
  1-Tailed (Drop):   p = 0.008

-----------------------------------------------------------
PANEL B: Between-Group Retention (Independent)
Test: Bootstrapped Mann-Whitney U
-----------------------------------------------------------
Early Retraining (Myrf WT vs Myrf cKO): p = 0.029

-----------------------------------------------------------
PANEL C: Retention Delta &amp; Distribution Shift
Test: Bootstrapped Proportion Difference (Threshold: &gt; -5%)
-----------------------------------------------------------
Proportion Forgetting Difference (p-value): 1.0000
Probability of Superiority (Myrf cKO &gt; Myrf WT):      0.1%
Prob. Stable Myrf WT (Delta &gt;= -5%):            78.5%
Prob. Stable Myrf cKO (Delta &gt;= -5%):           0.0%
Myrf WT 95% CI: [-8.73, 3.28]
Myrf cKO 95% CI:     [-14.81, -10.59]
============================================================
</pre></div>
</div>
</div>
</div>
<div class="alert alert-block alert-success">
    <b>Statistical Insight: The "Structural Bridge" of Myelin</b><br>
    Genetic ablation of adaptive myelination (<i>Myrf</i> cKO) confirms that new oligodendrocytes are the critical substrate for stabilizing long-term functional gains:
    <ul>
        <li><b>Deficit Specificity (Panel d):</b> Sliding window AUC analysis pinpoints the failure of consolidation. <i>Myrf</i> cKO mice exhibit a significant performance deficit specifically during the early retrieval phase (Window 2 [Days 2–3]: <b>p=0.026</b>), mirroring the exact window where VNS confers its advantage in wild-type mice.</li>
<li><b>Skill Deterioration (Panel e):</b> Without new myelin, the motor memory is unstable.
            <br>&nbsp;&nbsp;&nbsp;&nbsp;↳ <b>Myrf WT:</b> Exhibited near-perfect retention, with no significant change between learning and retrieval (<b>p=0.469</b>).
            <br>&nbsp;&nbsp;&nbsp;&nbsp;↳ <b>Myrf cKO:</b> Showed profound skill deterioration, with a statistically significant drop in performance over the hiatus (<b>p=0.017</b>).
</li>
<li><b>Total Loss of Stability (Panel f):</b> The distribution of "Retention Delta" reveals a stark binary outcome. While <b>78.5%</b> of <i>Myrf</i> WT mice maintained stable performance (Delta > -5%), <b>0%</b> of <i>Myrf</i> cKO mice were able to maintain their skill (Proportion Diff: <b>p=0.0005</b>).</li>
    </ul>
    <b>Conclusion:</b> These data identify remyelination as the critical "structural bridge" between temporary functional gains and long-term recovery; without it, functional improvements are transient and unstable.
</div></section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="figure6_Neuropixels.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Figure 6 Neuropixels</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-a-experimental-timeline">Panel a (Experimental Timeline)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-b-long-term-functional-recovery">Panel b: (Long-Term Functional Recovery)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-c-oligodendrocyte-quantity-vs-recovery">Panel c (Oligodendrocyte Quantity vs. Recovery)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-d-sheath-quantity-vs-recovery">Panel d (Sheath Quantity vs. Recovery)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-e-pattern-fidelity-drives-recovery">Panel e (Pattern Fidelity Drives Recovery)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-f-myrf-experimental-timeline">Panel f (Myrf Experimental Timeline)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#panel-g-oligodendrogenesis-is-required-for-paired-vns-efficacy">Panel g: Oligodendrogenesis is Required for Paired-VNS Efficacy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extended-data-figures">Extended Data Figures</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extended-data-figure-7">Extended Data Figure 7</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-f">a —- f</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#g">g</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#extended-data-figure-8">Extended Data Figure 8</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-c">a — c</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#d-f">d — f</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Shayok 'Shay' Dutta, PhD
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=bd9e20870c6007c4c509"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=bd9e20870c6007c4c509"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>